<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>The Group Object Security for Constrained RESTful Environments (Group OSCORE) Profile of the Authentication and Authorization for Constrained Environments (ACE) Framework</title>
<meta content="Marco Tiloca" name="author">
<meta content="Rikard HÃ¶glund" name="author">
<meta content="Francesca Palombini" name="author">
<meta content="
       This document specifies a profile for the Authentication and Authorization for Constrained Environments (ACE) framework. The profile uses Group Object Security for Constrained RESTful Environments (Group OSCORE) to provide communication security between a client and one or multiple resource servers that are members of an OSCORE group. The profile securely binds an OAuth 2.0 access token to the public key of the client associated with the private key used by that client in the OSCORE group. The profile uses Group OSCORE to achieve server authentication, as well as proof-of-possession for the client's public key. Also, it provides proof of the client's membership to the OSCORE group by binding the access token to information from the Group OSCORE Security Context, thus allowing the resource server(s) to verify the client's membership upon receiving a message protected with Group OSCORE from the client. Effectively, the profile enables fine-grained access control paired with secure group communication, in accordance with the Zero Trust principles. 
    " name="description">
<meta content="xml2rfc 3.23.2" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-ace-group-oscore-profile-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.23.2
    Python 3.12.7
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.4
    lxml 4.9.4
    platformdirs 4.3.6
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.32.3
    setuptools 70.3.0
    wcwidth 0.2.13
-->
<link href="draft-ietf-ace-group-oscore-profile.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "â";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Group OSCORE Profile of ACE</td>
<td class="right">October 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Tiloca, et al.</td>
<td class="center">Expires 15 April 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">ACE Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-ace-group-oscore-profile-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-10-12" class="published">12 October 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-04-15">15 April 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Tiloca</div>
<div class="org">RISE AB</div>
</div>
<div class="author">
      <div class="author-name">R. HÃ¶glund</div>
<div class="org">RISE AB</div>
</div>
<div class="author">
      <div class="author-name">F. Palombini</div>
<div class="org">Ericsson AB</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">The Group Object Security for Constrained RESTful Environments (Group OSCORE) Profile of the Authentication and Authorization for Constrained Environments (ACE) Framework</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies a profile for the Authentication and Authorization for Constrained Environments (ACE) framework. The profile uses Group Object Security for Constrained RESTful Environments (Group OSCORE) to provide communication security between a client and one or multiple resource servers that are members of an OSCORE group. The profile securely binds an OAuth 2.0 access token to the public key of the client associated with the private key used by that client in the OSCORE group. The profile uses Group OSCORE to achieve server authentication, as well as proof-of-possession for the client's public key. Also, it provides proof of the client's membership to the OSCORE group by binding the access token to information from the Group OSCORE Security Context, thus allowing the resource server(s) to verify the client's membership upon receiving a message protected with Group OSCORE from the client. Effectively, the profile enables fine-grained access control paired with secure group communication, in accordance with the Zero Trust principles.<a href="#section-abstract-1" class="pilcrow">Â¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">Â¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
    Authentication and Authorization for Constrained Environments Working Group mailing list (ace@ietf.org),
    which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/ace/">https://mailarchive.ietf.org/arch/browse/ace/</a></span>.<a href="#section-note.1-2" class="pilcrow">Â¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
    <span><a href="https://github.com/ace-wg/ace-group-oscore-profile">https://github.com/ace-wg/ace-group-oscore-profile</a></span>.<a href="#section-note.1-3" class="pilcrow">Â¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">Â¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">Â¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">Â¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 15 April 2025.<a href="#section-boilerplate.1-4" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">Â¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">â²</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.Â Â <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.Â Â <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.Â Â <a href="#name-protocol-overview" class="internal xref">Protocol Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="auto internal xref">2.1</a>.Â Â <a href="#name-pre-conditions" class="internal xref">Pre-Conditions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.Â Â <a href="#name-requesting-an-access-token" class="internal xref">Requesting an Access Token</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.Â Â <a href="#name-access-token-uploading" class="internal xref">Access Token Uploading</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="auto internal xref">2.4</a>.Â Â <a href="#name-secure-communication" class="internal xref">Secure Communication</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.Â Â <a href="#name-client-as-communication" class="internal xref">Client-AS Communication</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.Â Â <a href="#name-c-to-as-post-to-token-endpo" class="internal xref">C-to-AS: POST to Token Endpoint</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a href="#section-3.1.1" class="auto internal xref">3.1.1</a>.Â Â <a href="#name-context_id-parameter" class="internal xref">'context_id' Parameter</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a href="#section-3.1.2" class="auto internal xref">3.1.2</a>.Â Â <a href="#name-salt_input-parameter" class="internal xref">'salt_input' Parameter</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.3">
                    <p id="section-toc.1-1.3.2.1.2.3.1"><a href="#section-3.1.3" class="auto internal xref">3.1.3</a>.Â Â <a href="#name-client_cred_verify-paramete" class="internal xref">'client_cred_verify' Parameter</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.4">
                    <p id="section-toc.1-1.3.2.1.2.4.1"><a href="#section-3.1.4" class="auto internal xref">3.1.4</a>.Â Â <a href="#name-client_cred_verify_mac-para" class="internal xref">'client_cred_verify_mac' Parameter</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.Â Â <a href="#name-as-to-c-response" class="internal xref">AS-to-C: Response</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="auto internal xref">3.2.1</a>.Â Â <a href="#name-update-of-access-rights" class="internal xref">Update of Access Rights</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="auto internal xref">3.2.2</a>.Â Â <a href="#name-context_id-claim" class="internal xref">'context_id' Claim</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.3">
                    <p id="section-toc.1-1.3.2.2.2.3.1"><a href="#section-3.2.3" class="auto internal xref">3.2.3</a>.Â Â <a href="#name-salt_input-claim" class="internal xref">'salt_input' Claim</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.Â Â <a href="#name-client-rs-communication" class="internal xref">Client-RS Communication</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.Â Â <a href="#name-c-to-rs-post-to-authz-info-" class="internal xref">C-to-RS POST to /authz-info Endpoint</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.Â Â <a href="#name-rs-to-c-201-created" class="internal xref">RS-to-C: 2.01 (Created)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.Â Â <a href="#name-client-rs-secure-communicat" class="internal xref">Client-RS Secure Communication</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="auto internal xref">4.3.1</a>.Â Â <a href="#name-client-side" class="internal xref">Client Side</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.2">
                    <p id="section-toc.1-1.4.2.3.2.2.1"><a href="#section-4.3.2" class="auto internal xref">4.3.2</a>.Â Â <a href="#name-resource-server-side" class="internal xref">Resource Server Side</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.Â Â <a href="#name-update-of-access-rights-2" class="internal xref">Update of Access Rights</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="auto internal xref">4.5</a>.Â Â <a href="#name-access-rights-verification" class="internal xref">Access Rights Verification</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="auto internal xref">4.6</a>.Â Â <a href="#name-storing-multiple-access-tok" class="internal xref">Storing Multiple Access Tokens per PoP Key</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.Â Â <a href="#name-change-of-clients-authentic" class="internal xref">Change of Client's Authentication Credential in the Group</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.Â Â <a href="#name-secure-communication-with-t" class="internal xref">Secure Communication with the AS</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.Â Â <a href="#name-discarding-the-security-con" class="internal xref">Discarding the Security Context</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.Â Â <a href="#name-cbor-mappings" class="internal xref">CBOR Mappings</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.Â Â <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>.Â <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>.Â <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.Â Â <a href="#name-ace-profiles-registry" class="internal xref">ACE Profiles Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.Â Â <a href="#name-oauth-parameters-registry" class="internal xref">OAuth Parameters Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#section-11.3" class="auto internal xref">11.3</a>.Â Â <a href="#name-oauth-parameters-cbor-mappi" class="internal xref">OAuth Parameters CBOR Mappings Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.4">
                <p id="section-toc.1-1.11.2.4.1"><a href="#section-11.4" class="auto internal xref">11.4</a>.Â Â <a href="#name-cbor-web-token-cwt-claims-r" class="internal xref">CBOR Web Token (CWT) Claims Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.5">
                <p id="section-toc.1-1.11.2.5.1"><a href="#section-11.5" class="auto internal xref">11.5</a>.Â Â <a href="#name-tls-exporter-label-registry" class="internal xref">TLS Exporter Label Registry</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>.Â <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="auto internal xref">12.1</a>.Â Â <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="auto internal xref">12.2</a>.Â Â <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.Â Â <a href="#name-profile-requirements" class="internal xref">Profile Requirements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.Â Â <a href="#name-cddl-model" class="internal xref">CDDL Model</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.Â Â <a href="#name-document-updates" class="internal xref">Document Updates</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#appendix-C.1" class="auto internal xref">C.1</a>.Â Â <a href="#name-version-02-to-03" class="internal xref">Version -02 to -03</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#appendix-C.2" class="auto internal xref">C.2</a>.Â Â <a href="#name-version-01-to-02" class="internal xref">Version -01 to -02</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.3">
                <p id="section-toc.1-1.15.2.3.1"><a href="#appendix-C.3" class="auto internal xref">C.3</a>.Â Â <a href="#name-version-00-to-01" class="internal xref">Version -00 to -01</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#appendix-E" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">A number of applications rely on a group communication model where a client can access a resource hosted by multiple resource servers at once, e.g., over IP multicast. Typical examples include switching of luminaries, actuators control, and distribution of software updates. Secure communication in the group can be achieved by sharing a set of keying material, which is typically provided upon joining the group.<a href="#section-1-1" class="pilcrow">Â¶</a></p>
<p id="section-1-2">For some of such applications, it may be just fine to enforce access control in a straightforward fashion. That is, any client authorized to join the group, hence to obtain the group keying material, can be also implicitly authorized to perform any action at any resource of any server in the group. An example of application where such implicit authorization might serve well is a simple lighting scenario, where the lightbulbs are the servers, while the user account on an app on the user's phone is the client. In this case, it might be fine to not require additional authorization evidence from any user account, if it is acceptable that any current group member is also authorized to switch on and off any light, or to check the status of any light.<a href="#section-1-2" class="pilcrow">Â¶</a></p>
<p id="section-1-3">However, in different instances of such applications, the approach above is not desirable, as different group members are intended to have different access rights to resources of other group members. For instance, enforcing access control in accordance with a more fine-grained approach is required in the two following use cases.<a href="#section-1-3" class="pilcrow">Â¶</a></p>
<p id="section-1-4">As a first case, an application provides control of smart locks acting as servers in the group, where: a first type of client, e.g., a user account of a child, is allowed to only query the status of the smart locks; while a second type of client, e.g., a user account of a parent, is allowed to both query and change the status of the smart locks. Further similar applications concern the enforcement of different sets of permissions in groups with sensor/actuator devices, e.g., thermostats acting as servers. Also, some group members may even be intended as servers only. Hence, they must be prevented from acting as clients altogether and from accessing resources at other servers in the group, especially when attempting to perform non-safe operations.<a href="#section-1-4" class="pilcrow">Â¶</a></p>
<p id="section-1-5">As a second case, building automation scenarios often rely on servers that, under different circumstances, enforce different level of priority for processing received commands. For instance, BACnet deployments consider multiple classes of clients, e.g., a normal light switch (C1) and an emergency fire panel (C2). Then, a C1 client is not allowed to override a command from a C2 client, until the latter relinquishes control at its higher priority. That is: i) only C2 clients should be able to adjust the minimum required level of priority on the servers, so rightly locking out C1 clients if needed; and ii) when a server is set to accept only high-priority commands, only C2 clients should be able to perform such commands otherwise allowed also to C1 clients. Given the different maximum authority of different clients, fine-grained access control would effectively limit the execution of high- and emergency-priority commands only to devices that are in fact authorized to perform such actions. Besides, it would prevent a misconfigured or compromised device from initiating a high-priority command and lock out normal control.<a href="#section-1-5" class="pilcrow">Â¶</a></p>
<p id="section-1-6">In the cases above, being a legitimate group member and storing the group keying material is not supposed to imply any particular access rights. Instead, access control to the secure group communication channel and access control to the resource space provided by servers in the group should remain logically separated domains.<a href="#section-1-6" class="pilcrow">Â¶</a></p>
<p id="section-1-7">This is aligned with the Zero Trust paradigm <span>[<a href="#NIST-800-207" class="cite xref">NIST-800-207</a>]</span>, which focuses on resource protection and builds on the premise that trust is never granted implicitly, but must be continually evaluated. In particular, Zero Trust protections involve "minimizing access to resources (such as data and compute resources and applications/services) to only those subjects and assets identified as needing access as well as continually authenticating and authorizing the identity and security posture of each access request."<a href="#section-1-7" class="pilcrow">Â¶</a></p>
<p id="section-1-8">Furthermore, <span>[<a href="#NIST-800-207" class="cite xref">NIST-800-207</a>]</span> highlights how the Zero Trust goal is to "prevent unauthorized access to data and services coupled with making the access control enforcement as granular as possible", to "enforce least privileges needed to perform the action in the request."<a href="#section-1-8" class="pilcrow">Â¶</a></p>
<p id="section-1-9">As a step in this direction, one can be tempted to introduce a different security group for each different set of access rights. However, this inconveniently results in additional keying material to distribute and manage. In particular, if the access rights pertaining to a node change, this requires to evict the node from the group, after which the node has to join a different group aligned with its new access rights. Moreover, the keying material of both groups would have to be renewed for their current members. Overall, this would have a non negligible impact on operations and performance.<a href="#section-1-9" class="pilcrow">Â¶</a></p>
<p id="section-1-10">Instead, a fine-grained yet flexible access control model can be enforced within the same group, by using the Authentication and Authorization for Constrained Environments (ACE) framework <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>. That is, a client has to first obtain authorization credentials in the form of an access token, and upload it to the intended resource server(s) in the group before accessing the target resources hosted therein.<a href="#section-1-10" class="pilcrow">Â¶</a></p>
<p id="section-1-11">The ACE framework delegates to separate profile documents how to secure communications between the client and the resource servers. However each of the current profiles of ACE defined in <span>[<a href="#RFC9202" class="cite xref">RFC9202</a>]</span><span>[<a href="#RFC9203" class="cite xref">RFC9203</a>]</span><span>[<a href="#RFC9431" class="cite xref">RFC9431</a>]</span><span>[<a href="#I-D.ietf-ace-edhoc-oscore-profile" class="cite xref">I-D.ietf-ace-edhoc-oscore-profile</a>]</span> relies on a security protocol that cannot be used to protect one-to-many group messages, for example sent over IP multicast.<a href="#section-1-11" class="pilcrow">Â¶</a></p>
<p id="section-1-12">This document specifies the "coap_group_oscore" profile of the ACE framework, where a client uses the Constrained Application Protocol (CoAP) <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span><span>[<a href="#I-D.ietf-core-groupcomm-bis" class="cite xref">I-D.ietf-core-groupcomm-bis</a>]</span> to communicate with one or multiple resource servers that are members of an application group and share a common set of resources. This profile uses Group Object Security for Constrained RESTful Environments (Group OSCORE) <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span> as the security protocol to protect messages exchanged between the client and the resource servers. Hence, it requires that both the client and the resource servers have previously joined the same OSCORE group.<a href="#section-1-12" class="pilcrow">Â¶</a></p>
<p id="section-1-13">That is, this profile describes how access control is enforced for a client after it has joined an OSCORE group, to access resources hosted by other members in that group. The process for joining the OSCORE group through the respective Group Manager as defined in <span>[<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="cite xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span> takes place before the process described in this document, and is out of the scope of this profile.<a href="#section-1-13" class="pilcrow">Â¶</a></p>
<p id="section-1-14">The client proves its access to be authorized to the resource server(s) by using an access token bound to a key (the proof-of-possession key). This profile uses Group OSCORE to achieve server authentication and proof-of-possession for the client's public key used in the OSCORE group in question. Note that proof-of-possession is not achieved through a dedicated protocol element, but instead after the first message exchange protected with Group OSCORE.<a href="#section-1-14" class="pilcrow">Â¶</a></p>
<p id="section-1-15">Furthermore, this profile provides proof of the client's membership to the OSCORE group, by binding the access token to information from the pre-established Group OSCORE Security Context, as well as to the client's authentication credential used in the group and including the client's public key. This allows the resource server(s) to verify the client's group membership upon reception of a message protected with Group OSCORE from that client.<a href="#section-1-15" class="pilcrow">Â¶</a></p>
<p id="section-1-16">OSCORE <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span> specifies how to use COSE <span>[<a href="#RFC9052" class="cite xref">RFC9052</a>]</span><span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span> to secure CoAP messages. Group OSCORE builds on OSCORE to provide secure group communication, and ensures source authentication: by means of digital signatures embedded in the protected message (when using the group mode); or by protecting a message with pairwise keying material derived from the asymmetric keys of the two peers exchanging the message (when using the pairwise mode).<a href="#section-1-16" class="pilcrow">Â¶</a></p>
<div id="terminology">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCPÂ 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">Â¶</a></p>
<p id="section-1.1-2">Readers are expected to be familiar with the terms and concepts related to CBOR <span>[<a href="#RFC8949" class="cite xref">RFC8949</a>]</span>, COSE <span>[<a href="#RFC9052" class="cite xref">RFC9052</a>]</span><span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span>, CoAP <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>, OSCORE <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>, and Group OSCORE <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>. These especially include:<a href="#section-1.1-2" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-3.1">
            <p id="section-1.1-3.1.1">Group Manager, as the entity responsible for a set of groups where communications among members are secured with Group OSCORE.<a href="#section-1.1-3.1.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-1.1-3.2">
            <p id="section-1.1-3.2.1">Authentication credential, as the set of information associated with an entity, including that entity's public key and parameters associated with the public key. Examples of authentication credentials are CBOR Web Tokens (CWTs) and CWT Claims Sets (CCSs) <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>, X.509 certificates <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>, and C509 certificates <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>.<a href="#section-1.1-3.2.1" class="pilcrow">Â¶</a></p>
<p id="section-1.1-3.2.2">
Members of an OSCORE group have an associated authentication credential in the format used within the group. As per <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-2.4" class="relref">Section 2.4</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, an authentication credential provides the public key as well as the comprehensive set of information related to the public key algorithm, including, e.g., the used elliptic curve (when applicable).<a href="#section-1.1-3.2.2" class="pilcrow">Â¶</a></p>
</li>
        </ul>
<p id="section-1.1-4">Readers are also expected to be familiar with the terms and concepts described in the ACE framework for authentication and authorization <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>, as well as in the OSCORE profile of ACE <span>[<a href="#RFC9203" class="cite xref">RFC9203</a>]</span>. The terminology for entities in the considered architecture is defined in OAuth 2.0 <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>. In particular, this includes client (C), resource server (RS), and authorization server (AS).<a href="#section-1.1-4" class="pilcrow">Â¶</a></p>
<p id="section-1.1-5">Note that the term "endpoint" is used here following its OAuth definition <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>, aimed at denoting resources such as /token and /introspect at the AS, and /authz-info at the RS. This document does not use the CoAP definition of "endpoint", which is "An entity participating in the CoAP protocol".<a href="#section-1.1-5" class="pilcrow">Â¶</a></p>
<p id="section-1.1-6">Additionally, this document makes use of the following terminology.<a href="#section-1.1-6" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-7.1">
            <p id="section-1.1-7.1.1">Pairwise-only group: an OSCORE group that uses only the pairwise mode of Group OSCORE (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-8" class="relref">Section 8</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>).<a href="#section-1.1-7.1.1" class="pilcrow">Â¶</a></p>
</li>
        </ul>
<p id="section-1.1-8">Examples throughout this document are expressed in CBOR diagnostic notation as defined in <span><a href="https://rfc-editor.org/rfc/rfc8949#section-8" class="relref">Section 8</a> of [<a href="#RFC8949" class="cite xref">RFC8949</a>]</span> and <span><a href="https://rfc-editor.org/rfc/rfc8610#appendix-G" class="relref">Appendix G</a> of [<a href="#RFC8610" class="cite xref">RFC8610</a>]</span>. Diagnostic notation comments are often used to provide a textual representation of the parameters' keys and values.<a href="#section-1.1-8" class="pilcrow">Â¶</a></p>
<p id="section-1.1-9">In the CBOR diagnostic notation used in this document, constructs of the form e'SOME_NAME' are replaced by the value assigned to SOME_NAME in the CDDL model shown in <a href="#fig-cddl-model" class="auto internal xref">Figure 7</a> of <a href="#sec-cddl-model" class="auto internal xref">Appendix B</a>. For example, {e'context_id_param': h'abcd0000', e'salt_input_param': h'00} stands for {71: h'abcd0000', 72: h'00}.<a href="#section-1.1-9" class="pilcrow">Â¶</a></p>
<p id="section-1.1-10">Note to RFC Editor: Please delete the paragraph immediately preceding this note. Also, in the CBOR diagnostic notation used in this document, please replace the constructs of the form e'SOME_NAME' with the value assigned to SOME_NAME in the CDDL model shown in <a href="#fig-cddl-model" class="auto internal xref">Figure 7</a> of <a href="#sec-cddl-model" class="auto internal xref">Appendix B</a>. Finally, please delete this note.<a href="#section-1.1-10" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-protocol-overview">
<section id="section-2">
      <h2 id="name-protocol-overview">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-protocol-overview" class="section-name selfRef">Protocol Overview</a>
      </h2>
<p id="section-2-1">This section provides an overview of this profile, i.e., of how to use the ACE framework for authentication and authorization <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span> to secure communications between a client and one or more resource servers using Group OSCORE <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#section-2-1" class="pilcrow">Â¶</a></p>
<p id="section-2-2">Note that this profile of ACE describes how access control can be enforced for a node after it has joined an OSCORE group, to access resources hosted by other members in that group.<a href="#section-2-2" class="pilcrow">Â¶</a></p>
<p id="section-2-3">In particular, the process of joining the OSCORE group through the respective Group Manager as defined in <span>[<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="cite xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span> must take place before the process described in this document, and is out of the scope of this profile.<a href="#section-2-3" class="pilcrow">Â¶</a></p>
<p id="section-2-4">An overview of the protocol flow for this profile is shown in <a href="#fig-protocol-overview" class="auto internal xref">Figure 1</a>, where it is assumed that both the resource servers RS1 and RS2 are associated with the same authorization server AS. It is also assumed that the client C, as well as RS1 and RS2 have previously joined an OSCORE group with Group Identifier (gid) 0xabcd0000, and that they got assigned Sender ID (sid) 0x00, 0x01, and 0x02 in the group, respectively. The names of messages coincide with those of <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span> when applicable, and messages in square brackets are optional.<a href="#section-2-4" class="pilcrow">Â¶</a></p>
<span id="name-protocol-overview-2"></span><div id="fig-protocol-overview">
<figure id="figure-1">
        <div id="section-2-5.1">
          <div class="alignCenter art-svg artwork" id="section-2-5.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="960" width="576" viewBox="0 0 576 960" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,48 L 8,672" fill="none" stroke="black"></path>
              <path d="M 8,704 L 8,720" fill="none" stroke="black"></path>
              <path d="M 8,768 L 8,816" fill="none" stroke="black"></path>
              <path d="M 8,848 L 8,864" fill="none" stroke="black"></path>
              <path d="M 8,912 L 8,944" fill="none" stroke="black"></path>
              <path d="M 256,48 L 256,136" fill="none" stroke="black"></path>
              <path d="M 256,152 L 256,200" fill="none" stroke="black"></path>
              <path d="M 256,216 L 256,328" fill="none" stroke="black"></path>
              <path d="M 256,344 L 256,392" fill="none" stroke="black"></path>
              <path d="M 256,408 L 256,440" fill="none" stroke="black"></path>
              <path d="M 256,456 L 256,488" fill="none" stroke="black"></path>
              <path d="M 256,504 L 256,568" fill="none" stroke="black"></path>
              <path d="M 256,624 L 256,776" fill="none" stroke="black"></path>
              <path d="M 256,792 L 256,944" fill="none" stroke="black"></path>
              <path d="M 352,48 L 352,136" fill="none" stroke="black"></path>
              <path d="M 352,152 L 352,200" fill="none" stroke="black"></path>
              <path d="M 352,240 L 352,328" fill="none" stroke="black"></path>
              <path d="M 352,344 L 352,392" fill="none" stroke="black"></path>
              <path d="M 352,432 L 352,592" fill="none" stroke="black"></path>
              <path d="M 352,624 L 352,944" fill="none" stroke="black"></path>
              <path d="M 568,48 L 568,944" fill="none" stroke="black"></path>
              <path d="M 32,64 L 48,64" fill="none" stroke="black"></path>
              <path d="M 200,64 L 232,64" fill="none" stroke="black"></path>
              <path d="M 32,96 L 80,96" fill="none" stroke="black"></path>
              <path d="M 184,96 L 232,96" fill="none" stroke="black"></path>
              <path d="M 8,144 L 72,144" fill="none" stroke="black"></path>
              <path d="M 184,144 L 560,144" fill="none" stroke="black"></path>
              <path d="M 16,208 L 384,208" fill="none" stroke="black"></path>
              <path d="M 528,208 L 568,208" fill="none" stroke="black"></path>
              <path d="M 8,256 L 48,256" fill="none" stroke="black"></path>
              <path d="M 200,256 L 248,256" fill="none" stroke="black"></path>
              <path d="M 16,304 L 72,304" fill="none" stroke="black"></path>
              <path d="M 192,304 L 256,304" fill="none" stroke="black"></path>
              <path d="M 8,336 L 72,336" fill="none" stroke="black"></path>
              <path d="M 184,336 L 560,336" fill="none" stroke="black"></path>
              <path d="M 16,400 L 384,400" fill="none" stroke="black"></path>
              <path d="M 528,400 L 568,400" fill="none" stroke="black"></path>
              <path d="M 8,448 L 48,448" fill="none" stroke="black"></path>
              <path d="M 200,448 L 344,448" fill="none" stroke="black"></path>
              <path d="M 16,496 L 64,496" fill="none" stroke="black"></path>
              <path d="M 184,496 L 352,496" fill="none" stroke="black"></path>
              <path d="M 8,528 L 24,528" fill="none" stroke="black"></path>
              <path d="M 208,528 L 248,528" fill="none" stroke="black"></path>
              <path d="M 248,576 L 344,576" fill="none" stroke="black"></path>
              <path d="M 16,640 L 40,640" fill="none" stroke="black"></path>
              <path d="M 232,640 L 256,640" fill="none" stroke="black"></path>
              <path d="M 16,784 L 40,784" fill="none" stroke="black"></path>
              <path d="M 232,784 L 352,784" fill="none" stroke="black"></path>
              <path d="M 224,528 L 248,576" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="568,336 556,330.4 556,341.6" fill="black" transform="rotate(0,560,336)"></polygon>
              <polygon class="arrowhead" points="568,144 556,138.4 556,149.6" fill="black" transform="rotate(0,560,144)"></polygon>
              <polygon class="arrowhead" points="352,576 340,570.4 340,581.6" fill="black" transform="rotate(0,344,576)"></polygon>
              <polygon class="arrowhead" points="352,448 340,442.4 340,453.6" fill="black" transform="rotate(0,344,448)"></polygon>
              <polygon class="arrowhead" points="256,528 244,522.4 244,533.6" fill="black" transform="rotate(0,248,528)"></polygon>
              <polygon class="arrowhead" points="256,256 244,250.4 244,261.6" fill="black" transform="rotate(0,248,256)"></polygon>
              <polygon class="arrowhead" points="240,64 228,58.4 228,69.6" fill="black" transform="rotate(0,232,64)"></polygon>
              <polygon class="arrowhead" points="40,96 28,90.4 28,101.6" fill="black" transform="rotate(180,32,96)"></polygon>
              <polygon class="arrowhead" points="24,784 12,778.4 12,789.6" fill="black" transform="rotate(180,16,784)"></polygon>
              <polygon class="arrowhead" points="24,640 12,634.4 12,645.6" fill="black" transform="rotate(180,16,640)"></polygon>
              <polygon class="arrowhead" points="24,496 12,490.4 12,501.6" fill="black" transform="rotate(180,16,496)"></polygon>
              <polygon class="arrowhead" points="24,400 12,394.4 12,405.6" fill="black" transform="rotate(180,16,400)"></polygon>
              <polygon class="arrowhead" points="24,304 12,298.4 12,309.6" fill="black" transform="rotate(180,16,304)"></polygon>
              <polygon class="arrowhead" points="24,208 12,202.4 12,213.6" fill="black" transform="rotate(180,16,208)"></polygon>
              <g class="text">
                <text x="8" y="36">C</text>
                <text x="256" y="36">RS1</text>
                <text x="352" y="36">RS2</text>
                <text x="564" y="36">AS</text>
                <text x="24" y="68">[</text>
                <text x="92" y="68">Resource</text>
                <text x="160" y="68">Request</text>
                <text x="240" y="68">]</text>
                <text x="24" y="100">[</text>
                <text x="100" y="100">AS</text>
                <text x="144" y="100">Request</text>
                <text x="240" y="100">]</text>
                <text x="100" y="116">Creation</text>
                <text x="160" y="116">Hints</text>
                <text x="100" y="148">POST</text>
                <text x="148" y="148">/token</text>
                <text x="56" y="164">(aud:</text>
                <text x="108" y="164">"RS1",</text>
                <text x="156" y="164">sid:</text>
                <text x="200" y="164">0x00,</text>
                <text x="60" y="180">gid:</text>
                <text x="128" y="180">0xabcd0000,</text>
                <text x="196" y="180">...)</text>
                <text x="420" y="212">Access</text>
                <text x="472" y="212">token</text>
                <text x="508" y="212">T1</text>
                <text x="384" y="228">+</text>
                <text x="420" y="228">Access</text>
                <text x="496" y="228">Information</text>
                <text x="76" y="260">POST</text>
                <text x="144" y="260">/authz-info</text>
                <text x="108" y="276">(access_token:</text>
                <text x="184" y="276">T1)</text>
                <text x="100" y="308">2.01</text>
                <text x="152" y="308">Created</text>
                <text x="100" y="340">POST</text>
                <text x="148" y="340">/token</text>
                <text x="56" y="356">(aud:</text>
                <text x="108" y="356">"RS2",</text>
                <text x="156" y="356">sid:</text>
                <text x="200" y="356">0x00,</text>
                <text x="60" y="372">gid:</text>
                <text x="128" y="372">0xabcd0000,</text>
                <text x="196" y="372">...)</text>
                <text x="420" y="404">Access</text>
                <text x="472" y="404">token</text>
                <text x="508" y="404">T2</text>
                <text x="384" y="420">+</text>
                <text x="420" y="420">Access</text>
                <text x="496" y="420">Information</text>
                <text x="76" y="452">POST</text>
                <text x="144" y="452">/authz-info</text>
                <text x="108" y="468">(access_token:</text>
                <text x="184" y="468">T2)</text>
                <text x="92" y="500">2.01</text>
                <text x="144" y="500">Created</text>
                <text x="56" y="532">Group</text>
                <text x="108" y="532">OSCORE</text>
                <text x="168" y="532">Request</text>
                <text x="64" y="548">(kid:</text>
                <text x="112" y="548">0x00,</text>
                <text x="68" y="564">gid:</text>
                <text x="136" y="564">0xabcd0000)</text>
                <text x="256" y="596">|</text>
                <text x="312" y="612">/proof-of-possession/</text>
                <text x="72" y="644">Group</text>
                <text x="124" y="644">OSCORE</text>
                <text x="188" y="644">Response</text>
                <text x="96" y="660">(kid:</text>
                <text x="144" y="660">0x01)</text>
                <text x="88" y="692">/proof-of-possession/</text>
                <text x="32" y="740">/Mutual</text>
                <text x="124" y="740">authentication</text>
                <text x="40" y="756">between</text>
                <text x="80" y="756">C</text>
                <text x="104" y="756">and</text>
                <text x="140" y="756">RS1/</text>
                <text x="72" y="788">Group</text>
                <text x="124" y="788">OSCORE</text>
                <text x="188" y="788">Response</text>
                <text x="96" y="804">(kid:</text>
                <text x="144" y="804">0x02)</text>
                <text x="88" y="836">/proof-of-possession/</text>
                <text x="32" y="884">/Mutual</text>
                <text x="124" y="884">authentication</text>
                <text x="40" y="900">between</text>
                <text x="80" y="900">C</text>
                <text x="104" y="900">and</text>
                <text x="140" y="900">RS2/</text>
                <text x="120" y="932">...</text>
              </g>
            </svg><a href="#section-2-5.1.1" class="pilcrow">Â¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-protocol-overview-2" class="selfRef">Protocol Overview.</a>
        </figcaption></figure>
</div>
<div id="sec-protocol-overview-pre-conditions">
<section id="section-2.1">
        <h3 id="name-pre-conditions">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-pre-conditions" class="section-name selfRef">Pre-Conditions</a>
        </h3>
<p id="section-2.1-1">Using Group OSCORE and this profile requires that both the client and the resource servers have previously joined the same OSCORE group. This especially includes the derivation of the Group OSCORE Security Context and the assignment of unique Sender IDs to use in the group. Nodes can join the OSCORE group through the respective Group Manager by using the approach defined in <span>[<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="cite xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>, which is also based on ACE.<a href="#section-2.1-1" class="pilcrow">Â¶</a></p>
<p id="section-2.1-2">After the client and resource servers have joined the group, this profile provides access control for accessing resources on those resource servers, by securely communicating with Group OSCORE.<a href="#section-2.1-2" class="pilcrow">Â¶</a></p>
<p id="section-2.1-3">As a pre-requisite for this profile, the client has to have successfully joined the OSCORE group where also the resource servers (RSs) are members. Depending on the limited information initially available, the client may have to first discover the exact OSCORE group used by the RSs for the resources of interest, e.g., by using the approach defined in <span>[<a href="#I-D.tiloca-core-oscore-discovery" class="cite xref">I-D.tiloca-core-oscore-discovery</a>]</span>.<a href="#section-2.1-3" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="sec-protocol-overview-token-retrieval">
<section id="section-2.2">
        <h3 id="name-requesting-an-access-token">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-requesting-an-access-token" class="section-name selfRef">Requesting an Access Token</a>
        </h3>
<p id="section-2.2-1">This profile requires that the client requests an access token from the AS for the resource(s) that it wants to access at the RS(s), by using the /token endpoint as specified in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8" class="relref">Section 5.8</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>.<a href="#section-2.2-1" class="pilcrow">Â¶</a></p>
<p id="section-2.2-2">In general, different RSs can be associated with different ASs, even if the RSs are members of the same OSCORE group. However, assuming proper configurations and trust relations, it is possible for multiple RSs associated with the same AS to be part of a single audience (i.e., a group-audience, see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-6.9" class="relref">Section 6.9</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>). In such a case, the client can request a single access token intended for the group-audience, hence to all the RSs included therein. A particular group-audience might be defined as including all the RSs in the OSCORE group.<a href="#section-2.2-2" class="pilcrow">Â¶</a></p>
<p id="section-2.2-3">In the Access Token Request to the AS, the client <span class="bcp14">MUST</span> include the Group Identifier of the OSCORE group and its own Sender ID in that group. The AS <span class="bcp14">MUST</span> specify these pieces of information in the access token.<a href="#section-2.2-3" class="pilcrow">Â¶</a></p>
<p id="section-2.2-4">Furthermore, in the Access Token Request to the AS, the client <span class="bcp14">MUST</span> also include: its own authentication credential used in the OSCORE group; and a proof-of-possession (PoP) evidence to prove possession of the corresponding private key to the AS. The PoP evidence is computed over a PoP input uniquely related to the secure communication association between the client and the AS. The AS <span class="bcp14">MUST</span> include also the authentication credential specified by the client in the access token.<a href="#section-2.2-4" class="pilcrow">Â¶</a></p>
<p id="section-2.2-5">If the request from the client is granted, then the AS can send back the issued access token in the Access Token Response to the client, or instead upload the access token directly to the RS as described in the alternative workflow defined in <span>[<a href="#I-D.ietf-ace-workflow-and-params" class="cite xref">I-D.ietf-ace-workflow-and-params</a>]</span>. This document focuses on the former option (also shown in the example in <a href="#fig-protocol-overview" class="auto internal xref">Figure 1</a>), while the latter option is not detailed further here.<a href="#section-2.2-5" class="pilcrow">Â¶</a></p>
<p id="section-2.2-6">The Access Token Request and Response exchanged between the client and the AS <span class="bcp14">MUST</span> be confidentiality-protected and ensure authenticity. In this profile, it is <span class="bcp14">RECOMMENDED</span> to use OSCORE <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span> between the client and the AS, to reduce the number of libraries that the client has to support. Other protocols fulfilling the security requirements defined in Sections <a href="https://rfc-editor.org/rfc/rfc9200#section-5" class="relref">5</a> and <a href="https://rfc-editor.org/rfc/rfc9200#section-6" class="relref">6</a> of <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span> <span class="bcp14">MAY</span> alternatively be used, such as TLS <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span> or DTLS <span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span>.<a href="#section-2.2-6" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="sec-protocol-overview-token-posting">
<section id="section-2.3">
        <h3 id="name-access-token-uploading">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-access-token-uploading" class="section-name selfRef">Access Token Uploading</a>
        </h3>
<p id="section-2.3-1">After having retrieved the access token from the AS, the client uploads the access token to the RS, by sending a POST request to the /authz-info endpoint and using the mechanisms specified in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.10" class="relref">Section 5.10</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>. When using this profile, the communication that C has with the /authz-info endpoint is not protected.<a href="#section-2.3-1" class="pilcrow">Â¶</a></p>
<p id="section-2.3-2">If the access token is valid, the RS replies to the POST request with a 2.01 (Created) response. Also, the RS associates the received access token with the Group OSCORE Security Context identified by the Group Identifier specified in the access token (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-2.1.3" class="relref">Section 2.1.3</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>). In practice, the RS maintains a collection of Security Contexts with associated authorization information, for all the clients that it is currently communicating with. The authorization information is a policy that is used as input when processing requests from those clients.<a href="#section-2.3-2" class="pilcrow">Â¶</a></p>
<p id="section-2.3-3">Finally, the RS stores the association between i) the authorization information from the access token; and ii) the Group Identifier of the OSCORE group together with the Sender ID and the authentication credential of the client in that group (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-2" class="relref">Section 2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>). This binds the access token to the Group OSCORE Security Context of the OSCORE group.<a href="#section-2.3-3" class="pilcrow">Â¶</a></p>
<p id="section-2.3-4">Finally, when the client communicates with the RS using the Group OSCORE Security Context, the RS verifies that the client is a legitimate member of the OSCORE group and especially the exact group member with the same Sender ID associated with the access token. This occurs when verifying a request protected with Group OSCORE, since the request includes the client's Sender ID and either it embeds a signature computed also over that Sender ID (if protected with the group mode), or it is protected by means of pairwise symmetric keying material derived from the asymmetric keys of the two peers (if protected with the pairwise mode).<a href="#section-2.3-4" class="pilcrow">Â¶</a></p>
<p id="section-2.3-5">The above has considered an access token intended for a single RS. However, as discussed in <a href="#sec-protocol-overview-token-retrieval" class="auto internal xref">Section 2.2</a>, an access token can be intended for a group-audience including multiple RSs in the OSCORE group. In such a case, the client could efficiently upload the access token to many or all of those RSs at once (e.g., over IP multicast), after which each RS individually performs the same steps described above.<a href="#section-2.3-5" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="sec-protocol-overview-communication">
<section id="section-2.4">
        <h3 id="name-secure-communication">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-secure-communication" class="section-name selfRef">Secure Communication</a>
        </h3>
<p id="section-2.4-1">The client can send a request protected with Group OSCORE <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span> to the RS. This can be a unicast request targeting the RS, or a one-to-many group request (e.g., over IP multicast) targeting the OSCORE group where the RS is also a member. To this end, the client uses the Group OSCORE Security Context already established upon joining the OSCORE group, e.g., by using the approach defined in <span>[<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="cite xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>. The RS may send a response back to the client, protecting it by means of the same Group OSCORE Security Context.<a href="#section-2.4-1" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-c-as-comm">
<section id="section-3">
      <h2 id="name-client-as-communication">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-client-as-communication" class="section-name selfRef">Client-AS Communication</a>
      </h2>
<p id="section-3-1">This section details the Access Token POST Request that the client sends to the /token endpoint of the AS, as well as the related Access Token Response.<a href="#section-3-1" class="pilcrow">Â¶</a></p>
<p id="section-3-2">The access token <span class="bcp14">MUST</span> be bound to the public key of the client as proof-of-possession key (PoP key), which is included in the client's authentication credential specified in the 'cnf' claim of the access token.<a href="#section-3-2" class="pilcrow">Â¶</a></p>
<div id="sec-c-as-token-endpoint">
<section id="section-3.1">
        <h3 id="name-c-to-as-post-to-token-endpo">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-c-to-as-post-to-token-endpo" class="section-name selfRef">C-to-AS: POST to Token Endpoint</a>
        </h3>
<p id="section-3.1-1">The Client-to-AS request is specified in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.1" class="relref">Section 5.8.1</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>. The client <span class="bcp14">MUST</span> send this POST request to the /token endpoint over a secure channel that guarantees authentication, message integrity, and confidentiality.<a href="#section-3.1-1" class="pilcrow">Â¶</a></p>
<p id="section-3.1-2">The POST request is formatted as the analogous Client-to-AS request in the OSCORE profile of ACE (see <span><a href="https://rfc-editor.org/rfc/rfc9203#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC9203" class="cite xref">RFC9203</a>]</span>), with the following additional parameters that <span class="bcp14">MUST</span> be included in the payload.<a href="#section-3.1-2" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-3.1">
            <p id="section-3.1-3.1.1">'context_id', defined in <a href="#context_id" class="auto internal xref">Section 3.1.1</a> of this document. This parameter specifies the Group Identifier (GID), i.e., the ID Context of an OSCORE group that includes as members both the client and the RS(s) in the audience for which the access token is asked to be issued. In particular, the client wishes to communicate with the RS(s) in that audience using the Group OSCORE Security Context associated with that OSCORE group.<a href="#section-3.1-3.1.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-3.1-3.2">
            <p id="section-3.1-3.2.1">'salt_input', defined in <a href="#salt_input" class="auto internal xref">Section 3.1.2</a> of this document. This parameter includes the Sender ID that the client has in the OSCORE group whose GID is specified in the 'context_id' parameter above.<a href="#section-3.1-3.2.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-3.1-3.3">
            <p id="section-3.1-3.3.1">'req_cnf', defined in <span><a href="https://rfc-editor.org/rfc/rfc9201#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC9201" class="cite xref">RFC9201</a>]</span>. This parameter follows the syntax from <span><a href="https://rfc-editor.org/rfc/rfc8747#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC8747" class="cite xref">RFC8747</a>]</span>, and its inner confirmation value specifies the authentication credential that the client uses in the OSCORE group. The public key included in the authentication credential will be used as the PoP key bound to the access token.<a href="#section-3.1-3.3.1" class="pilcrow">Â¶</a></p>
<p id="section-3.1-3.3.2">
At the time of writing this specification, acceptable formats of authentication credentials in Group OSCORE are CBOR Web Tokens (CWTs) and CWT Claims Sets (CCSs) <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>, X.509 certificates <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>, and C509 certificates <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>.<a href="#section-3.1-3.3.2" class="pilcrow">Â¶</a></p>
<p id="section-3.1-3.3.3">
Further formats may be available in the future, and would be acceptable to use as long as they comply with the criteria compiled in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-2.4" class="relref">Section 2.4</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>. In particular, an authentication credential has to explicitly include the public key as well as the comprehensive set of information related to the public key algorithm, including, e.g., the used elliptic curve (when applicable).<a href="#section-3.1-3.3.3" class="pilcrow">Â¶</a></p>
<p id="section-3.1-3.3.4">
[ As to CWTs and CCSs, the CWT Confirmation Methods 'kcwt' and 'kccs' are under pending registration requested by draft-ietf-ace-edhoc-oscore-profile. ]<a href="#section-3.1-3.3.4" class="pilcrow">Â¶</a></p>
<p id="section-3.1-3.3.5">
[ As to X.509 certificates, the CWT Confirmation Methods 'x5bag' and '5chain' are under pending registration requested by draft-ietf-ace-edhoc-oscore-profile. ]<a href="#section-3.1-3.3.5" class="pilcrow">Â¶</a></p>
<p id="section-3.1-3.3.6">
[ As to C509 certificates, the CWT Confirmation Methods 'c5b'and 'c5c' are under pending registration requested by draft-ietf-ace-edhoc-oscore-profile. ]<a href="#section-3.1-3.3.6" class="pilcrow">Â¶</a></p>
</li>
        </ul>
<p id="section-3.1-4">In addition, the client computes its proof-of-possession (PoP) evidence, in order to prove to the AS the possession of its own private key used in the OSCORE group. This allows the AS to verify that the client indeed owns the private key associated with the public key of the authentication credential that the client allegedly uses in the OSCORE group.<a href="#section-3.1-4" class="pilcrow">Â¶</a></p>
<p id="section-3.1-5">To this end, the client <span class="bcp14">MUST</span> use as PoP input the byte representation of an information that uniquely represents the secure communication association between the client and the AS. It is <span class="bcp14">RECOMMENDED</span> that the client uses the following as PoP input.<a href="#section-3.1-5" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-6.1">
            <p id="section-3.1-6.1.1">If the client and the AS communicate over TLS 1.2 <span>[<a href="#RFC5246" class="cite xref">RFC5246</a>]</span> or DTLS 1.2 <span>[<a href="#RFC6347" class="cite xref">RFC6347</a>]</span>, the PoP input is an exporter value computed as defined in <span><a href="https://rfc-editor.org/rfc/rfc5705#section-4" class="relref">Section 4</a> of [<a href="#RFC5705" class="cite xref">RFC5705</a>]</span>, using the following inputs:<a href="#section-3.1-6.1.1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-6.1.2.1">
                <p id="section-3.1-6.1.2.1.1">The exporter label "EXPORTER-ACE-PoP-Input-Client-AS", defined in <a href="#iana-tls-exporter-label" class="auto internal xref">Section 11.5</a> of this document.<a href="#section-3.1-6.1.2.1.1" class="pilcrow">Â¶</a></p>
</li>
              <li class="normal" id="section-3.1-6.1.2.2">
                <p id="section-3.1-6.1.2.2.1">The empty 'context value', i.e., a 'context value' of zero-length.<a href="#section-3.1-6.1.2.2.1" class="pilcrow">Â¶</a></p>
</li>
              <li class="normal" id="section-3.1-6.1.2.3">
                <p id="section-3.1-6.1.2.3.1">32 as length value in bytes.<a href="#section-3.1-6.1.2.3.1" class="pilcrow">Â¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-3.1-6.2">
            <p id="section-3.1-6.2.1">If the client and the AS communicate over TLS 1.3 <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span> or DTLS 1.3 <span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span>, the PoP input is an exporter value computed as defined in <span><a href="https://rfc-editor.org/rfc/rfc8446#section-7.5" class="relref">Section 7.5</a> of [<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>, using the following inputs:<a href="#section-3.1-6.2.1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-6.2.2.1">
                <p id="section-3.1-6.2.2.1.1">The exporter label "EXPORTER-ACE-PoP-Input-Client-AS", defined in <a href="#iana-tls-exporter-label" class="auto internal xref">Section 11.5</a> of this document.<a href="#section-3.1-6.2.2.1.1" class="pilcrow">Â¶</a></p>
</li>
              <li class="normal" id="section-3.1-6.2.2.2">
                <p id="section-3.1-6.2.2.2.1">The empty 'context_value', i.e., a 'context_value' of zero-length.<a href="#section-3.1-6.2.2.2.1" class="pilcrow">Â¶</a></p>
</li>
              <li class="normal" id="section-3.1-6.2.2.3">
                <p id="section-3.1-6.2.2.3.1">32 as 'key_length' in bytes.<a href="#section-3.1-6.2.2.3.1" class="pilcrow">Â¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-3.1-6.3">
            <p id="section-3.1-6.3.1">If the client and the AS communicate over OSCORE <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>, the PoP input is the output PRK of an HKDF-Extract step <span>[<a href="#RFC5869" class="cite xref">RFC5869</a>]</span>, i.e., PRK = HMAC-Hash(salt, IKM).<a href="#section-3.1-6.3.1" class="pilcrow">Â¶</a></p>
<p id="section-3.1-6.3.2">
In particular, given the OSCORE Security Context CTX shared between the client and the AS, then the following applies.<a href="#section-3.1-6.3.2" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-6.3.3.1">
                <p id="section-3.1-6.3.3.1.1">'salt' takes (x1 | x2), where | denotes byte string concatenation, while x1 and x2 are defined as follows.<a href="#section-3.1-6.3.3.1.1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-6.3.3.1.2.1">
                    <p id="section-3.1-6.3.3.1.2.1.1">x1 is the binary representation of a CBOR data item. If CTX does not specify an OSCORE ID Context, the CBOR data item is the CBOR simple value <code>null</code> (0xf6). Otherwise, the CBOR data item is a CBOR byte string, with value the OSCORE ID Context specified in CTX.<a href="#section-3.1-6.3.3.1.2.1.1" class="pilcrow">Â¶</a></p>
</li>
                  <li class="normal" id="section-3.1-6.3.3.1.2.2">
                    <p id="section-3.1-6.3.3.1.2.2.1">x2 is the binary representation of a CBOR byte string. The value of the CBOR byte string is the OSCORE Sender ID of the client, which the client stores in its Sender Context of CTX and the AS stores in its Recipient Context of CTX.<a href="#section-3.1-6.3.3.1.2.2.1" class="pilcrow">Â¶</a></p>
</li>
                </ul>
</li>
              <li class="normal" id="section-3.1-6.3.3.2">
                <p id="section-3.1-6.3.3.2.1">'IKM' is the OSCORE Master Secret specified in CTX.<a href="#section-3.1-6.3.3.2.1" class="pilcrow">Â¶</a></p>
</li>
              <li class="normal" id="section-3.1-6.3.3.3">
                <p id="section-3.1-6.3.3.3.1">The used HKDF is the HKDF Algorithm specified in CTX.<a href="#section-3.1-6.3.3.3.1" class="pilcrow">Â¶</a></p>
</li>
            </ul>
<p id="section-3.1-6.3.4">
The following shows an example of input to the HMAC-Hash() function.<a href="#section-3.1-6.3.4" class="pilcrow">Â¶</a></p>
<p id="section-3.1-6.3.5">
On the client side, the OSCORE Security Context shared with the AS includes:<a href="#section-3.1-6.3.5" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1-6.3.6">
<pre>
ID Context: 0x37cbf3210017a2d3 (8 bytes)

Sender ID: 0x01 (1 byte)

Master Secret: 0x0102030405060708090a0b0c0d0e0f10 (16 bytes)
</pre><a href="#section-3.1-6.3.6" class="pilcrow">Â¶</a>
</div>
<p id="section-3.1-6.3.7">
Then, the following holds.<a href="#section-3.1-6.3.7" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1-6.3.8">
<pre>
x1 (Raw value) (8 bytes)
0x37cbf3210017a2d3

x1 (CBOR Data Item) (9 bytes)
0x4837cbf3210017a2d3

x2 (Raw value) (1 bytes)
0x01

x2 (CBOR Data Item) (2 bytes)
0x4101

salt (11 bytes)
0x4837cbf3210017a2d34101

IKM (16 bytes)
0x0102030405060708090a0b0c0d0e0f10
</pre><a href="#section-3.1-6.3.8" class="pilcrow">Â¶</a>
</div>
</li>
        </ul>
<p id="section-3.1-7">After that, the client computes the PoP evidence as follows.<a href="#section-3.1-7" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-8.1">
            <p id="section-3.1-8.1.1">If the OSCORE group is not a pairwise-only group, the PoP evidence <span class="bcp14">MUST</span> be a signature. The client computes the signature by using the same private key and signature algorithm it uses for signing messages in the OSCORE group. The client's private key is the one associated with the client's authentication credential used in the OSCORE group and specified in the 'req_cnf' parameter above.<a href="#section-3.1-8.1.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-3.1-8.2">
            <p id="section-3.1-8.2.1">If the OSCORE group is a pairwise-only group, the PoP evidence <span class="bcp14">MUST</span> be a MAC computed as follows, by using the HKDF Algorithm HKDF SHA-256, which consists of composing the HKDF-Extract and HKDF-Expand steps <span>[<a href="#RFC5869" class="cite xref">RFC5869</a>]</span>.<a href="#section-3.1-8.2.1" class="pilcrow">Â¶</a></p>
<p id="section-3.1-8.2.2">
MAC = HKDF(salt, IKM, info, L)<a href="#section-3.1-8.2.2" class="pilcrow">Â¶</a></p>
<p id="section-3.1-8.2.3">
The input parameters of HKDF are as follows.<a href="#section-3.1-8.2.3" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-8.2.4.1">
                <p id="section-3.1-8.2.4.1.1">salt takes as value the empty byte string.<a href="#section-3.1-8.2.4.1.1" class="pilcrow">Â¶</a></p>
</li>
              <li class="normal" id="section-3.1-8.2.4.2">
                <p id="section-3.1-8.2.4.2.1">IKM is computed as a cofactor Diffie-Hellman shared secret (see Section 5.7.1.2 of <span>[<a href="#NIST-800-56A" class="cite xref">NIST-800-56A</a>]</span>), using the ECDH algorithm that is used as Pairwise Key Agreement Algorithm in the OSCORE group. The client uses its own Diffie-Hellman private key and the Diffie-Hellman public key of the AS. For X25519 and X448, the procedure is described in <span><a href="https://rfc-editor.org/rfc/rfc7748#section-5" class="relref">Section 5</a> of [<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>.<a href="#section-3.1-8.2.4.2.1" class="pilcrow">Â¶</a></p>
<p id="section-3.1-8.2.4.2.2">
The client's private key is the one associated with the client's authentication credential used in the OSCORE group and specified in the 'req_cnf' parameter above. The client may obtain the Diffie-Hellman public key of the AS during its registration process at the AS.<a href="#section-3.1-8.2.4.2.2" class="pilcrow">Â¶</a></p>
</li>
              <li class="normal" id="section-3.1-8.2.4.3">
                <p id="section-3.1-8.2.4.3.1">info takes as value the PoP input.<a href="#section-3.1-8.2.4.3.1" class="pilcrow">Â¶</a></p>
</li>
              <li class="normal" id="section-3.1-8.2.4.4">
                <p id="section-3.1-8.2.4.4.1">L is equal to 8, i.e., the size of the MAC, in bytes.<a href="#section-3.1-8.2.4.4.1" class="pilcrow">Â¶</a></p>
</li>
            </ul>
</li>
        </ul>
<p id="section-3.1-9">Finally, the client <span class="bcp14">MUST</span> include one of the two following parameters in the payload of the POST request to the AS.<a href="#section-3.1-9" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-10.1">
            <p id="section-3.1-10.1.1">'client_cred_verify', defined in <a href="#client_cred_verify" class="auto internal xref">Section 3.1.3</a> of this document, specifying the client's PoP evidence as a signature, which is computed as defined above. This parameter <span class="bcp14">MUST</span> be included if and only if the OSCORE group is not a pairwise-only group.<a href="#section-3.1-10.1.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-3.1-10.2">
            <p id="section-3.1-10.2.1">'client_cred_verify_mac', defined in <a href="#client_cred_verify_mac" class="auto internal xref">Section 3.1.4</a> of this document, specifying the client's PoP evidence as a MAC, which is computed as defined above. This parameter <span class="bcp14">MUST</span> be included if and only if the OSCORE group is a pairwise-only group.<a href="#section-3.1-10.2.1" class="pilcrow">Â¶</a></p>
</li>
        </ul>
<p id="section-3.1-11">An example of such a request is shown in <a href="#fig-example-C-to-AS-symm" class="auto internal xref">Figure 2</a>.<a href="#section-3.1-11" class="pilcrow">Â¶</a></p>
<span id="name-example-c-to-as-post-token-"></span><div id="fig-example-C-to-AS-symm">
<figure id="figure-2">
          <div class="alignLeft art-text artwork" id="section-3.1-12.1">
<pre>
Header: POST (Code=0.02)
Uri-Host: "as.example.com"
Uri-Path: "token"
Content-Format: 19 (application/ace+cbor)
Payload:
{
  / audience /        5 : "tempSensor4711",
  / scope /           9 : "read",
    e'context_id_param' : h'abcd0000',
    e'salt_input_param' : h'00',
  e'client_cred_verify' : h'c5a6...f100' / elided for brevity /,
  / req_cnf /         4 : {
    e'kccs' : {
      / sub / 2 : "42-50-31-FF-EF-37-32-39",
      / cnf / 8 : {
        / COSE_Key / 1 : {
          / kty /  1 : 2 / EC2 /,
          / crv / -1 : 1 / P-256 /,
          / x /   -2 : h'd7cc072de2205bdc1537a543d53c60a6
                         acb62eccd890c7fa27c9e354089bbe13',
          / y /   -3 : h'f95e1d4b851a2cc80fff87d8e23f22af
                         b725d535e515d020731e79a3b4e47120'
        }
      }
    }
  }
}
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-example-c-to-as-post-token-" class="selfRef">Example C-to-AS POST /token Request for an Access Token Bound to an Asymmetric Key.</a>
          </figcaption></figure>
</div>
<p id="section-3.1-13">In the example above, the client specifies that its authentication credential in the OSCORE group is the CCS shown in <a href="#fig-client-auth-cred" class="auto internal xref">Figure 3</a>.<a href="#section-3.1-13" class="pilcrow">Â¶</a></p>
<span id="name-example-of-client-authentic"></span><div id="fig-client-auth-cred">
<figure id="figure-3">
          <div class="alignLeft art-text artwork" id="section-3.1-14.1">
<pre>
{
  / sub / 2 : "42-50-31-FF-EF-37-32-39",
  / cnf / 8 : {
    / COSE_Key / 1 : {
      / kty /  1 : 2 / EC2 /,
      / crv / -1 : 1 / P-256 /,
      / x /   -2 : h'd7cc072de2205bdc1537a543d53c60a6
                     acb62eccd890c7fa27c9e354089bbe13',
      / y /   -3 : h'f95e1d4b851a2cc80fff87d8e23f22af
                     b725d535e515d020731e79a3b4e47120'
    }
  }
}
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-example-of-client-authentic" class="selfRef">Example of client Authentication Credential as CWT Claims Set (CCS).</a>
          </figcaption></figure>
</div>
<p id="section-3.1-15">[<a href="#section-3.1-15" class="pilcrow">Â¶</a></p>
<p id="section-3.1-16">TODO: Specify how C requests a new access token that dynamically updates its access rights. (See <a href="#sec-as-update-access-rights" class="auto internal xref">Section 3.2.1</a> for pre-requirements and a high-level direction)<a href="#section-3.1-16" class="pilcrow">Â¶</a></p>
<p id="section-3.1-17">]<a href="#section-3.1-17" class="pilcrow">Â¶</a></p>
<div id="context_id">
<section id="section-3.1.1">
          <h4 id="name-context_id-parameter">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-context_id-parameter" class="section-name selfRef">'context_id' Parameter</a>
          </h4>
<p id="section-3.1.1-1">The 'context_id' parameter is an <span class="bcp14">OPTIONAL</span> parameter of the Access Token Request message defined in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.1" class="relref">Section 5.8.1</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>. This parameter provides a value that the client wishes to use with the RS as a hint for a security context. Its exact content is profile specific.<a href="#section-3.1.1-1" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="salt_input">
<section id="section-3.1.2">
          <h4 id="name-salt_input-parameter">
<a href="#section-3.1.2" class="section-number selfRef">3.1.2. </a><a href="#name-salt_input-parameter" class="section-name selfRef">'salt_input' Parameter</a>
          </h4>
<p id="section-3.1.2-1">The 'salt_input' parameter is an <span class="bcp14">OPTIONAL</span> parameter of the Access Token Request message defined in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.1" class="relref">Section 5.8.1</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>. This parameter provides a value that the client wishes to use as part of a salt with the RS, for deriving cryptographic keying material. Its exact content is profile specific.<a href="#section-3.1.2-1" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="client_cred_verify">
<section id="section-3.1.3">
          <h4 id="name-client_cred_verify-paramete">
<a href="#section-3.1.3" class="section-number selfRef">3.1.3. </a><a href="#name-client_cred_verify-paramete" class="section-name selfRef">'client_cred_verify' Parameter</a>
          </h4>
<p id="section-3.1.3-1">The 'client_cred_verify' parameter is an <span class="bcp14">OPTIONAL</span> parameter of the Access Token Request message defined in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.1." class="relref">Section 5.8.1.</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>. This parameter provides a signature computed by the client to prove the possession of its own private key.<a href="#section-3.1.3-1" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="client_cred_verify_mac">
<section id="section-3.1.4">
          <h4 id="name-client_cred_verify_mac-para">
<a href="#section-3.1.4" class="section-number selfRef">3.1.4. </a><a href="#name-client_cred_verify_mac-para" class="section-name selfRef">'client_cred_verify_mac' Parameter</a>
          </h4>
<p id="section-3.1.4-1">The 'client_cred_verify_mac' parameter is an <span class="bcp14">OPTIONAL</span> parameter of the Access Token Request message defined in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.1." class="relref">Section 5.8.1.</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>. This parameter provides a Message Authentication Code (MAC) computed by the client to prove the possession of its own private key.<a href="#section-3.1.4-1" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-as-c-token">
<section id="section-3.2">
        <h3 id="name-as-to-c-response">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-as-to-c-response" class="section-name selfRef">AS-to-C: Response</a>
        </h3>
<p id="section-3.2-1">After having verified the POST request to the /token endpoint and that the client is authorized to obtain an access token corresponding to its Access Token Request, the AS <span class="bcp14">MUST</span> verify the proof-of-possession (PoP) evidence. In particular, the AS proceeds as follows.<a href="#section-3.2-1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-2.1">
            <p id="section-3.2-2.1.1">As PoP input, the AS uses the same value used by the client in <a href="#sec-c-as-token-endpoint" class="auto internal xref">Section 3.1</a>.<a href="#section-3.2-2.1.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-3.2-2.2">
            <p id="section-3.2-2.2.1">As public key of the client, the AS uses the one included in the authentication credential specified in the 'req_cnf' parameter of the Access Token Request.<a href="#section-3.2-2.2.1" class="pilcrow">Â¶</a></p>
<p id="section-3.2-2.2.2">
This requires the AS to support the format of the authentication credential specified in the 'req_cnf' parameter, i.e., the format of authentication credential that is used in the OSCORE group where the client uses that authentication credential. Practically, this is not an issue, since an RS supporting this profile is expected to be registered only at an AS that supports the formats of authentication credential that the RS supports.<a href="#section-3.2-2.2.2" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-3.2-2.3">
            <p id="section-3.2-2.3.1">If the Access Token Request includes the 'client_cred_verify' parameter, this specifies the PoP evidence as a signature. Then, the AS verifies the signature by using the public key of the client.<a href="#section-3.2-2.3.1" class="pilcrow">Â¶</a></p>
<p id="section-3.2-2.3.2">
This requires the AS to support the signature algorithm and curve (when applicable) that are used in the OSCORE group where the client uses the authentication credential specified in the 'req_cnf' parameter of the Access Token Request. Practically, this is not an issue, since an RS supporting this profile is expected to be registered only at an AS that supports the signature algorithms and curves (when applicable) that the RS supports.<a href="#section-3.2-2.3.2" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-3.2-2.4">
            <p id="section-3.2-2.4.1">If the Access Token Request includes the 'client_cred_verify_mac' parameter, this specifies the PoP evidence as a Message Authentication Code (MAC).<a href="#section-3.2-2.4.1" class="pilcrow">Â¶</a></p>
<p id="section-3.2-2.4.2">
Then, the AS recomputes the MAC through the same process taken by the client when preparing the value of the 'client_cred_verify_mac' parameter for the access token (see <a href="#sec-c-as-token-endpoint" class="auto internal xref">Section 3.1</a>), with the difference that the AS uses its own Diffie-Hellman private key and the Diffie-Hellman public key of the client. The verification succeeds if and only if the recomputed MAC is equal to the MAC conveyed as PoP evidence in the Access Token Request.<a href="#section-3.2-2.4.2" class="pilcrow">Â¶</a></p>
<p id="section-3.2-2.4.3">
This requires the AS to support the ECDH algorithm that is used as Pairwise Key Agreement Algorithm in the OSCORE group where the client uses the authentication credential specified in the 'req_cnf' parameter of the Access Token Request. Practically, this is not an issue, since an RS supporting this profile is expected to be registered only at an AS that supports the ECDH algorithms that the RS supports.<a href="#section-3.2-2.4.3" class="pilcrow">Â¶</a></p>
</li>
        </ul>
<p id="section-3.2-3">If both the 'client_cred_verify' and 'client_cred_verify_mac' parameters are present, or if the verification of the PoP evidence fails, the AS considers the client request invalid.<a href="#section-3.2-3" class="pilcrow">Â¶</a></p>
<p id="section-3.2-4">If the client request was invalid or not authorized, the AS returns an error response as described in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.3" class="relref">Section 5.8.3</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>.<a href="#section-3.2-4" class="pilcrow">Â¶</a></p>
<p id="section-3.2-5">If all verifications are successful, the AS responds as defined in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.2" class="relref">Section 5.8.2</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>. In particular:<a href="#section-3.2-5" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-6.1">
            <p id="section-3.2-6.1.1">The AS can signal that the use of Group OSCORE is <span class="bcp14">REQUIRED</span> for a specific access token by including the 'ace_profile' parameter with the value "coap_group_oscore" in the Access Token Response. The client <span class="bcp14">MUST</span> use Group OSCORE towards all the resource servers for which this access token is valid. Usually, it is assumed that constrained devices will be pre-configured with the necessary profile, so that this kind of profile signaling can be omitted.<a href="#section-3.2-6.1.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-3.2-6.2">
            <p id="section-3.2-6.2.1">The AS <span class="bcp14">MUST NOT</span> include the 'rs_cnf' parameter defined in <span>[<a href="#RFC9201" class="cite xref">RFC9201</a>]</span>. In general, the AS may not be aware of the authentication credentials (and public keys included thereof) that the RSs use in the OSCORE group. Also, the client is able to retrieve the authentication credentials of other group members from the responsible Group Manager, both upon joining the group or later on as a group member, as defined in <span>[<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="cite xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>.<a href="#section-3.2-6.2.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-3.2-6.3">
            <p id="section-3.2-6.3.1">According to this document, the AS includes the 'access_token' parameter specifying the issued access token in the Access Token Response. An alternative workflow where the access token is uploaded by the AS directly to the RS is described in <span>[<a href="#I-D.ietf-ace-workflow-and-params" class="cite xref">I-D.ietf-ace-workflow-and-params</a>]</span>.<a href="#section-3.2-6.3.1" class="pilcrow">Â¶</a></p>
</li>
        </ul>
<p id="section-3.2-7">The AS <span class="bcp14">MUST</span> include the following information as metadata of the issued access token. The use of CBOR web tokens (CWT) as specified in <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span> is <span class="bcp14">RECOMMENDED</span>.<a href="#section-3.2-7" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-8.1">
            <p id="section-3.2-8.1.1">The profile "coap_group_oscore". If the access token is a CWT, this is specified in the 'ace_profile' claim of the access token, as per <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.10" class="relref">Section 5.10</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>.<a href="#section-3.2-8.1.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-3.2-8.2">
            <p id="section-3.2-8.2.1">The salt input specified in the 'salt_input' parameter of the Access Token Request. If the access token is a CWT, the content of the 'salt_input' parameter <span class="bcp14">MUST</span> be specified in the 'salt_input' claim of the access token, defined in <a href="#salt_input_claim" class="auto internal xref">Section 3.2.3</a> of this document.<a href="#section-3.2-8.2.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-3.2-8.3">
            <p id="section-3.2-8.3.1">The Context ID input specified in the 'context_id' parameter of the Access Token Request. If the access token is a CWT, the content of the 'context_id' parameter <span class="bcp14">MUST</span> be specified in the 'context_id' claim of the access token, defined in <a href="#context_id_claim" class="auto internal xref">Section 3.2.2</a> of this document.<a href="#section-3.2-8.3.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-3.2-8.4">
            <p id="section-3.2-8.4.1">The authentication credential that the client uses in the OSCORE group and specified in the 'req_cnf' parameter of the Access Token Request.<a href="#section-3.2-8.4.1" class="pilcrow">Â¶</a></p>
<p id="section-3.2-8.4.2">
If the access token is a CWT, the client's authentication credential <span class="bcp14">MUST</span> be specified in the 'cnf' claim, which follows the syntax from <span><a href="https://rfc-editor.org/rfc/rfc8747#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC8747" class="cite xref">RFC8747</a>]</span>. In particular, the 'cnf' claim includes the same authentication credential specified in the 'req_cnf' parameter of the Access Token Request (see <a href="#sec-c-as-token-endpoint" class="auto internal xref">Section 3.1</a>).<a href="#section-3.2-8.4.2" class="pilcrow">Â¶</a></p>
</li>
        </ul>
<p id="section-3.2-9"><a href="#fig-example-AS-to-C" class="auto internal xref">Figure 4</a> shows an example of such an AS response. The access token has been truncated for readability.<a href="#section-3.2-9" class="pilcrow">Â¶</a></p>
<span id="name-example-as-to-c-access-toke"></span><div id="fig-example-AS-to-C">
<figure id="figure-4">
          <div class="alignLeft art-text artwork" id="section-3.2-10.1">
<pre>
Header: Created (Code=2.01)
Content-Format: 19 (application/ace+cbor)
Payload:
{
  / access_token / 1 : h'8343a1010aa2044c...00', / elided for brevity /
  / ace_profile / 38 : e'coap_group_oscore',
  / expires_in /   2 : 3600
}
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-example-as-to-c-access-toke" class="selfRef">Example AS-to-C Access Token Response with the Group OSCORE Profile.</a>
          </figcaption></figure>
</div>
<p id="section-3.2-11"><a href="#fig-example-AS-to-C-CWT" class="auto internal xref">Figure 5</a> shows an example CWT Claims Set, containing the client's public key in the group (as PoP key), as specified by the inner confirmation value in the 'cnf' claim.<a href="#section-3.2-11" class="pilcrow">Â¶</a></p>
<span id="name-example-cwt-claims-set"></span><div id="fig-example-AS-to-C-CWT">
<figure id="figure-5">
          <div class="alignLeft art-text artwork" id="section-3.2-12.1">
<pre>
{
  / aud /           3 : "tempSensorInLivingRoom",
  / iat /           6 : 1719820800,
  / exp /           4 : 2035353600,
  / scope /         9 : "temperature_g firmware_p",
  e'context_id_claim' : h'abcd0000',
  e'salt_input_claim' : h'00',
  / cnf /           8 : {
    e'kccs' : {
      / sub / 2 : "42-50-31-FF-EF-37-32-39",
      / cnf / 8 : {
        / COSE_Key / 1 : {
          / kty /  1 : 2 / EC2 /,
          / crv / -1 : 1 / P-256 /,
          / x /   -2 : h'd7cc072de2205bdc1537a543d53c60a6
                         acb62eccd890c7fa27c9e354089bbe13',
          / y /   -3 : h'f95e1d4b851a2cc80fff87d8e23f22af
                         b725d535e515d020731e79a3b4e47120'
        }
      }
    }
  }
}
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-example-cwt-claims-set" class="selfRef">Example CWT Claims Set.</a>
          </figcaption></figure>
</div>
<p id="section-3.2-13">The same CWT Claims Set as in <a href="#fig-example-AS-to-C-CWT" class="auto internal xref">Figure 5</a> and encoded in CBOR is shown in <a href="#fig-example-AS-to-C-CWT-encoding" class="auto internal xref">Figure 6</a>, using the value abbreviations defined in <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span> and <span>[<a href="#RFC8747" class="cite xref">RFC8747</a>]</span>. The bytes in hexadecimal are reported in the first column, while their corresponding CBOR meaning is reported after the "#" sign on the second column, for easiness of readability.<a href="#section-3.2-13" class="pilcrow">Â¶</a></p>
<p id="section-3.2-14">Editor's note: it should be checked (and in case fixed) that the values used below (which are not yet registered) are the final values registered by IANA.<a href="#section-3.2-14" class="pilcrow">Â¶</a></p>
<span id="name-example-cwt-claims-set-usin"></span><div id="fig-example-AS-to-C-CWT-encoding">
<figure id="figure-6">
          <div class="alignLeft art-text artwork" id="section-3.2-15.1">
<pre>
A7                                      # map(7)
   03                                   # unsigned(3)
   76                                   # text(22)
      74656D7053656E736F72496E4C6976696E67526F6F6D
      # "tempSensorInLivingRoom"
   06                                   # unsigned(6)
   1A 66826200                          # unsigned(1719820800)
   04                                   # unsigned(4)
   1A 79510800                          # unsigned(2035353600)
   09                                   # unsigned(9)
   78 18                                # text(24)
      74656D70657261747572655F67206669726D776172655F70
      # "temperature_g firmware_p"
   18 33                                # unsigned(51)
   44                                   # bytes(4)
      ABCD0000
   18 34                                # unsigned(52)
   41                                   # bytes(1)
      00
   08                                   # unsigned(8)
   A1                                   # map(1)
      0E                                # unsigned(14)
      A2                                # map(2)
         02                             # unsigned(2)
         77                             # text(23)
            34322D35302D33312D46462D45462D33372D33322D3339
            # "42-50-31-FF-EF-37-32-39"
         08                             # unsigned(8)
         A1                             # map(1)
            01                          # unsigned(1)
            A4                          # map(4)
               01                       # unsigned(1)
               02                       # unsigned(2)
               20                       # negative(0)
               01                       # unsigned(1)
               21                       # negative(1)
               58 20                    # bytes(32)
                  D7CC072DE2205BDC1537A543D53C60A6
                  ACB62ECCD890C7FA27C9E354089BBE13
               22                       # negative(2)
               58 20                    # bytes(32)
                  F95E1D4B851A2CC80FFF87D8E23F22AF
                  B725D535E515D020731E79A3B4E47120
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-example-cwt-claims-set-usin" class="selfRef">Example CWT Claims Set Using CBOR Encoding.</a>
          </figcaption></figure>
</div>
<div id="sec-as-update-access-rights">
<section id="section-3.2.1">
          <h4 id="name-update-of-access-rights">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-update-of-access-rights" class="section-name selfRef">Update of Access Rights</a>
          </h4>
<p id="section-3.2.1-1">[<a href="#section-3.2.1-1" class="pilcrow">Â¶</a></p>
<p id="section-3.2.1-2">TODO: Specify how the AS issues an access token that dynamically updates the access rights of C. (See below for pre-requirements and a high-level direction)<a href="#section-3.2.1-2" class="pilcrow">Â¶</a></p>
<p id="section-3.2.1-3">(This should be specified with content in the present section, as well as in <a href="#sec-c-as-token-endpoint" class="auto internal xref">Section 3.1</a> and <a href="#sec-rs-update-access-rights" class="auto internal xref">Section 4.4</a>).<a href="#section-3.2.1-3" class="pilcrow">Â¶</a></p>
<p id="section-3.2.1-4">At the moment, this profile does not support the dynamic update of access rights for the client like other transport profiles of ACE do.<a href="#section-3.2.1-4" class="pilcrow">Â¶</a></p>
<p id="section-3.2.1-5">This can be enabled by building on concepts defined in <span>[<a href="#I-D.ietf-ace-workflow-and-params" class="cite xref">I-D.ietf-ace-workflow-and-params</a>]</span>:<a href="#section-3.2.1-5" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.1-6.1">
              <p id="section-3.2.1-6.1.1">"Token series" - In this profile, it would be specialized as a set of consecutive access tokens issued by the AS for the pair (C, AUD), where C is the client whose public authentication credential is bound to those access tokens, while AUD is the audience for which C requests those access tokens.<a href="#section-3.2.1-6.1.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-3.2.1-6.2">
              <p id="section-3.2.1-6.2.1">"token_series_id" - At the time of writing, <span>[<a href="#I-D.ietf-ace-workflow-and-params" class="cite xref">I-D.ietf-ace-workflow-and-params</a>]</span> describes the intended direction for defining this new prospective parameter, to be used in the Access Token Request/Response exchange between C and the AS.<a href="#section-3.2.1-6.2.1" class="pilcrow">Â¶</a></p>
<p id="section-3.2.1-6.2.2">
This parameter is meant to specify the unique identifier of a token series. In parallel, it is planned to define a new, corresponding claim to include into access tokens.<a href="#section-3.2.1-6.2.2" class="pilcrow">Â¶</a></p>
</li>
          </ul>
<p id="section-3.2.1-7">At a high-level, the above can enable the dynamic update of access rights as follows:<a href="#section-3.2.1-7" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.1-8.1">
              <p id="section-3.2.1-8.1.1">Each access token in a token series includes the claim "token_series_id", with value the identifier of the token series that the access token belongs to.<a href="#section-3.2.1-8.1.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-3.2.1-8.2">
              <p id="section-3.2.1-8.2.1">When issuing the first access token in a token series, the AS includes the parameter "token_series_id" in the Access Token Response to the client, with value the identifier of the token series that the access token belongs to.<a href="#section-3.2.1-8.2.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-3.2.1-8.3">
              <p id="section-3.2.1-8.3.1">When C requests from the AS an access token that dynamically updates its current access rights to access protected resources at the same audience, C sends to the AS an Access Token Request such that:<a href="#section-3.2.1-8.3.1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.1-8.3.2.1">
                  <p id="section-3.2.1-8.3.2.1.1">It includes the parameter "token_series_id", with value the identifier of the token series for which the new access token is requested.<a href="#section-3.2.1-8.3.2.1.1" class="pilcrow">Â¶</a></p>
</li>
                <li class="normal" id="section-3.2.1-8.3.2.2">
                  <p id="section-3.2.1-8.3.2.2.1">It does <em>not</em> include the parameters "context_id", "salt_input", and "client_cred_verify" or "client_cred_verify_mac".<a href="#section-3.2.1-8.3.2.2.1" class="pilcrow">Â¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-3.2.1-8.4">
              <p id="section-3.2.1-8.4.1">If the AS issues the new access token that dynamically updated the access rights of C, then the access token includes the claim "token_series_id", with value the identifier of the same token series for which the access token has been issued.<a href="#section-3.2.1-8.4.1" class="pilcrow">Â¶</a></p>
</li>
          </ul>
<p id="section-3.2.1-9">When receiving the new access token, the RS uses the value of the claim "token_series_id", and identifies the stored old access token that has to be superseded by the new one, as both belonging to the same token series.<a href="#section-3.2.1-9" class="pilcrow">Â¶</a></p>
<p id="section-3.2.1-10">]<a href="#section-3.2.1-10" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="context_id_claim">
<section id="section-3.2.2">
          <h4 id="name-context_id-claim">
<a href="#section-3.2.2" class="section-number selfRef">3.2.2. </a><a href="#name-context_id-claim" class="section-name selfRef">'context_id' Claim</a>
          </h4>
<p id="section-3.2.2-1">The 'context_id' claim provides a value that the client requesting the access token wishes to use with the RS, as a hint for a security context.<a href="#section-3.2.2-1" class="pilcrow">Â¶</a></p>
<p id="section-3.2.2-2">This parameter specifies the value of the Context ID input, encoded as a CBOR byte string.<a href="#section-3.2.2-2" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="salt_input_claim">
<section id="section-3.2.3">
          <h4 id="name-salt_input-claim">
<a href="#section-3.2.3" class="section-number selfRef">3.2.3. </a><a href="#name-salt_input-claim" class="section-name selfRef">'salt_input' Claim</a>
          </h4>
<p id="section-3.2.3-1">The 'salt_input' claim provides a value that the client requesting the access token wishes to use as a part of a salt with the RS, e.g., for deriving cryptographic material.<a href="#section-3.2.3-1" class="pilcrow">Â¶</a></p>
<p id="section-3.2.3-2">This parameter specifies the value of the salt input, encoded as a CBOR byte string.<a href="#section-3.2.3-2" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-c-rs-comm">
<section id="section-4">
      <h2 id="name-client-rs-communication">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-client-rs-communication" class="section-name selfRef">Client-RS Communication</a>
      </h2>
<p id="section-4-1">This section details the POST request and response to the /authz-info endpoint between the client and the RS.<a href="#section-4-1" class="pilcrow">Â¶</a></p>
<p id="section-4-2">The proof-of-possession required to bind the access token to the client is explicitly performed when the RS receives and verifies a request from the client protected with Group OSCORE, either with the group mode (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-7" class="relref">Section 7</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>) or with the pairwise mode (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-8" class="relref">Section 8</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>).<a href="#section-4-2" class="pilcrow">Â¶</a></p>
<p id="section-4-3">In particular, the RS uses the client's public key bound to the access token, either when verifying the signature of the request (if protected with the group mode), or when verifying the request as integrity-protected with pairwise keying material derived from the two peers' authentication credentials and asymmetric keys (if protected with the pairwise mode). In either case, the RS also authenticates the client.<a href="#section-4-3" class="pilcrow">Â¶</a></p>
<p id="section-4-4">Similarly, when receiving a protected response from the RS, the client uses the RS's public key either when verifying the signature of the response (if protected with the group mode), or when verifying the response as integrity-protected with pairwise keying material derived from the two peers' authentication credentials and asymmetric keys (if protected with the pairwise mode). In either case, the client also authenticates the RS. Mutual authentication is only achieved after the client has successfully verified the protected response from the RS.<a href="#section-4-4" class="pilcrow">Â¶</a></p>
<p id="section-4-5">Therefore, an attacker using a stolen access token cannot generate a valid Group OSCORE message as protected through the client's private key, and thus cannot prove possession of the PoP key bound to the access token. Also, if a client legitimately owns an access token but has not joined the OSCORE group, it cannot generate a valid Group OSCORE message, as it does not store the necessary keying material shared among the group members.<a href="#section-4-5" class="pilcrow">Â¶</a></p>
<p id="section-4-6">Furthermore, a client C1 is supposed to obtain a valid access token from the AS, as specifying its own authentication credential (and the public key included thereof) associated with its own private key used in the OSCORE group, together with its own Sender ID in that OSCORE group (see <a href="#sec-c-as-token-endpoint" class="auto internal xref">Section 3.1</a>). This allows the RS receiving the access token to verify with the Group Manager of that OSCORE group whether such a client indeed has that Sender ID and uses that authentication credential in the OSCORE group.<a href="#section-4-6" class="pilcrow">Â¶</a></p>
<p id="section-4-7">As a consequence, a different client C2, also member of the same OSCORE group, is not able to impersonate C1, by: i) getting a valid access token, specifying the Sender ID of C1 and a different (made-up) authentication credential; ii) successfully posting the access token to the RS; and then iii) attempting to communicate using Group OSCORE and impersonating C1, while also blaming C1 for the consequences of the interaction with the RS.<a href="#section-4-7" class="pilcrow">Â¶</a></p>
<div id="sec-c-rs-authz">
<section id="section-4.1">
        <h3 id="name-c-to-rs-post-to-authz-info-">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-c-to-rs-post-to-authz-info-" class="section-name selfRef">C-to-RS POST to /authz-info Endpoint</a>
        </h3>
<p id="section-4.1-1">The client uploads the access token to the /authz-info endpoint of the RS, as defined in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.10.1" class="relref">Section 5.10.1</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>.<a href="#section-4.1-1" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="sec-rs-c-created">
<section id="section-4.2">
        <h3 id="name-rs-to-c-201-created">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-rs-to-c-201-created" class="section-name selfRef">RS-to-C: 2.01 (Created)</a>
        </h3>
<p id="section-4.2-1">The RS <span class="bcp14">MUST</span> verify the validity of the access token as defined in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.10.1" class="relref">Section 5.10.1</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>, with the following additions.<a href="#section-4.2-1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-2.1">
            <p id="section-4.2-2.1.1">The RS <span class="bcp14">MUST</span> check that the claims 'salt_input', 'context_id', and 'cnf' are included in the access token.<a href="#section-4.2-2.1.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-4.2-2.2">
            <p id="section-4.2-2.2.1">The RS considers: the content of the 'context_id' claim as the GID of the OSCORE group; the content of the 'salt_input' claim as the Sender ID that the client has in the group; and the inner confirmation value of the 'cnf' claim as the authentication credential that the client uses in the group.<a href="#section-4.2-2.2.1" class="pilcrow">Â¶</a></p>
<p id="section-4.2-2.2.2">
The RS <span class="bcp14">MUST</span> check whether it already stores the authentication credential specified in the inner confirmation value of the 'cnf' claim as associated with the pair (GID, Sender ID) above.<a href="#section-4.2-2.2.2" class="pilcrow">Â¶</a></p>
<p id="section-4.2-2.2.3">
If this is not the case, the RS <span class="bcp14">MUST</span> request the client's authentication credential to the Group Manager of the OSCORE group as described in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-oscore-16#section-9.3" class="relref">Section 9.3</a> of [<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="cite xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>, specifying the client's Sender ID in the OSCORE group, i.e., the value of the 'salt_input' claim. Then, the RS performs the following actions.<a href="#section-4.2-2.2.3" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-2.2.4.1">
                <p id="section-4.2-2.2.4.1.1">The RS <span class="bcp14">MUST</span> check whether the client's authentication credential retrieved from the Group Manager matches the one retrieved from the inner confirmation value of the 'cnf' claim of the access token.<a href="#section-4.2-2.2.4.1.1" class="pilcrow">Â¶</a></p>
</li>
              <li class="normal" id="section-4.2-2.2.4.2">
                <p id="section-4.2-2.2.4.2.1">The RS <span class="bcp14">MUST</span> check whether the client's Sender ID provided by the Group Manager together with the client's authentication credential matches the one retrieved from the 'salt_input' claim of the access token.<a href="#section-4.2-2.2.4.2.1" class="pilcrow">Â¶</a></p>
</li>
            </ul>
</li>
        </ul>
<p id="section-4.2-3">If any of the checks above fails, the RS <span class="bcp14">MUST</span> consider the access token invalid, and <span class="bcp14">MUST</span> reply to the client with an error response code equivalent to the CoAP code 4.00 (Bad Request).<a href="#section-4.2-3" class="pilcrow">Â¶</a></p>
<p id="section-4.2-4">If the access token is valid and further checks on its content are successful, the RS associates the authorization information from the access token with the Group OSCORE Security Context.<a href="#section-4.2-4" class="pilcrow">Â¶</a></p>
<p id="section-4.2-5">In particular, the RS associates the authorization information from the access token with the triple (GID, SaltInput, AuthCred), where GID is the Group Identifier of the OSCORE group, while SaltInput and AuthCred are the Sender ID and the authentication credential that the client uses in that OSCORE group, respectively.<a href="#section-4.2-5" class="pilcrow">Â¶</a></p>
<p id="section-4.2-6">The RS <span class="bcp14">MUST</span> keep this association up-to-date over time, as the triple (GID, SaltInput, AuthCred) associated with the access token might change. In particular:<a href="#section-4.2-6" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-7.1">
            <p id="section-4.2-7.1.1">If the OSCORE group is rekeyed (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-12.2" class="relref">Section 12.2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span> and <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-oscore-16#section-11" class="relref">Section 11</a> of [<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="cite xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>), the Group Identifier also changes in the group, and the new one replaces the current 'GID' value in the triple (GID, SaltInput, AuthCred).<a href="#section-4.2-7.1.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-4.2-7.2">
            <p id="section-4.2-7.2.1">If the client requests and obtains a new OSCORE Sender ID from the Group Manager (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-2.6.3.1" class="relref">Section 2.6.3.1</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span> and <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-oscore-16#section-9.2" class="relref">Section 9.2</a> of [<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="cite xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>), the new Sender ID replaces the current 'SaltInput' value in the triple (GID, SaltInput, AuthCred).<a href="#section-4.2-7.2.1" class="pilcrow">Â¶</a></p>
</li>
        </ul>
<p id="section-4.2-8">As defined in <a href="#sec-client-public-key-change" class="auto internal xref">Section 5</a>, a possible change of the client's authentication credential requires the client to upload to the RS a new access token bound to the new authentication credential.<a href="#section-4.2-8" class="pilcrow">Â¶</a></p>
<p id="section-4.2-9">Finally, the RS <span class="bcp14">MUST</span> send a 2.01 (Created) response to the client, as defined in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.10.1" class="relref">Section 5.10.1</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>.<a href="#section-4.2-9" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="sec-client-rs-secure-communication">
<section id="section-4.3">
        <h3 id="name-client-rs-secure-communicat">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-client-rs-secure-communicat" class="section-name selfRef">Client-RS Secure Communication</a>
        </h3>
<p id="section-4.3-1">When previously joining the OSCORE group, both the client and the RS have already established the related Group OSCORE Security Context to communicate as group members. Therefore, they can simply start to securely communicate using Group OSCORE, without deriving any additional keying material or security association.<a href="#section-4.3-1" class="pilcrow">Â¶</a></p>
<p id="section-4.3-2">If either of the client or the RS deletes an access token (e.g., when the access token has expired or has been revoked), it <span class="bcp14">MUST NOT</span> delete the related Group OSCORE Security Context. The client <span class="bcp14">MAY</span> request a new access token from the AS, to be uploaded to the RS for re-enabling access to protected resources for the client.<a href="#section-4.3-2" class="pilcrow">Â¶</a></p>
<div id="client-side">
<section id="section-4.3.1">
          <h4 id="name-client-side">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-client-side" class="section-name selfRef">Client Side</a>
          </h4>
<p id="section-4.3.1-1">After having received the 2.01 (Created) response from the RS, following the POST request to the /authz-info endpoint, the client starts the communication with the RS, by sending a request protected with Group OSCORE using the Group OSCORE Security Context <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#section-4.3.1-1" class="pilcrow">Â¶</a></p>
<p id="section-4.3.1-2">When communicating with the RS to access the resources as specified by the authorization information, the client <span class="bcp14">MUST</span> use the Group OSCORE Security Context of the pertinent OSCORE group, whose GID was specified in the 'context_id' parameter of the Access Token Request.<a href="#section-4.3.1-2" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="resource-server-side">
<section id="section-4.3.2">
          <h4 id="name-resource-server-side">
<a href="#section-4.3.2" class="section-number selfRef">4.3.2. </a><a href="#name-resource-server-side" class="section-name selfRef">Resource Server Side</a>
          </h4>
<p id="section-4.3.2-1">After successful validation of the access token as defined in <a href="#sec-rs-c-created" class="auto internal xref">Section 4.2</a> and after having sent the 2.01 (Created) response, the RS can start to communicate with the client using Group OSCORE <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#section-4.3.2-1" class="pilcrow">Â¶</a></p>
<p id="section-4.3.2-2">When processing an incoming request protected with Group OSCORE, the RS <span class="bcp14">MUST</span> consider as valid client's authentication credential only the one associated with the stored access token. As defined in <a href="#sec-client-public-key-change" class="auto internal xref">Section 5</a>, a possible change of the client's authentication credential requires the client to upload to the RS a new access token bound to the new authentication credential.<a href="#section-4.3.2-2" class="pilcrow">Â¶</a></p>
<p id="section-4.3.2-3">For every incoming request, if Group OSCORE verification succeeds, the verification of access rights is performed as described in <a href="#sec-c-rs-access-rights" class="auto internal xref">Section 4.5</a>.<a href="#section-4.3.2-3" class="pilcrow">Â¶</a></p>
<p id="section-4.3.2-4">If the RS receives a request protected with a Group OSCORE Security Context CTX, the target resource requires authorization, and the RS does not store a valid access token related to CTX, then the RS <span class="bcp14">MUST</span> reply with a 4.01 (Unauthorized) error response protected with CTX.<a href="#section-4.3.2-4" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-rs-update-access-rights">
<section id="section-4.4">
        <h3 id="name-update-of-access-rights-2">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-update-of-access-rights-2" class="section-name selfRef">Update of Access Rights</a>
        </h3>
<p id="section-4.4-1">[<a href="#section-4.4-1" class="pilcrow">Â¶</a></p>
<p id="section-4.4-2">TODO: Specify the processing on the RS when receiving an access token that dynamically updates the access rights of C. (See <a href="#sec-as-update-access-rights" class="auto internal xref">Section 3.2.1</a> for pre-requirements and a high-level direction)<a href="#section-4.4-2" class="pilcrow">Â¶</a></p>
<p id="section-4.4-3">]<a href="#section-4.4-3" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="sec-c-rs-access-rights">
<section id="section-4.5">
        <h3 id="name-access-rights-verification">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-access-rights-verification" class="section-name selfRef">Access Rights Verification</a>
        </h3>
<p id="section-4.5-1">The RS <span class="bcp14">MUST</span> follow the procedures defined in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.10.2" class="relref">Section 5.10.2</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>. If an RS receives a request protected with Group OSCORE from a client, the RS processes the request according to <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#section-4.5-1" class="pilcrow">Â¶</a></p>
<p id="section-4.5-2">If the Group OSCORE verification succeeds and the target resource requires authorization, the RS retrieves the authorization information from the access token associated with the Group OSCORE Security Context. Then, the RS <span class="bcp14">MUST</span> verify that the action requested on the resource is authorized.<a href="#section-4.5-2" class="pilcrow">Â¶</a></p>
<p id="section-4.5-3">If the RS has no valid access token for the client, the RS <span class="bcp14">MUST</span> reject the request and <span class="bcp14">MUST</span> reply to the client with a 4.01 (Unauthorized) error response.<a href="#section-4.5-3" class="pilcrow">Â¶</a></p>
<p id="section-4.5-4">If the RS has an access token for the client but no actions are authorized on the target resource, the RS <span class="bcp14">MUST</span> reject the request and <span class="bcp14">MUST</span> reply to the client with a 4.03 (Forbidden) error response.<a href="#section-4.5-4" class="pilcrow">Â¶</a></p>
<p id="section-4.5-5">If the RS has an access token for the client but the requested action is not authorized, the RS <span class="bcp14">MUST</span> reject the request and <span class="bcp14">MUST</span> reply to the client with a 4.05 (Method Not Allowed) error response.<a href="#section-4.5-5" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="storing-multiple-access-tokens-per-pop-key">
<section id="section-4.6">
        <h3 id="name-storing-multiple-access-tok">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-storing-multiple-access-tok" class="section-name selfRef">Storing Multiple Access Tokens per PoP Key</a>
        </h3>
<p id="section-4.6-1">According to <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.10.1" class="relref">Section 5.10.1</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>, an RS is recommended to store only one access token per proof-of-possession (PoP) key, and to supersede such an access token when receiving and successfully validating a new one bound to the same PoP key.<a href="#section-4.6-1" class="pilcrow">Â¶</a></p>
<p id="section-4.6-2">However, when using the profile specified in this document, an RS might practically have to deviate from that recommendation and store multiple access tokens bound to the same PoP key, i.e., to the same public authentication credential of a client.<a href="#section-4.6-2" class="pilcrow">Â¶</a></p>
<p id="section-4.6-3">For example, this can occur in the following cases.<a href="#section-4.6-3" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.6-4.1">
            <p id="section-4.6-4.1.1">The RS is the single RS associated with an audience AUD1, and also belongs to a group-audience AUD2 (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-6.9" class="relref">Section 6.9</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>).<a href="#section-4.6-4.1.1" class="pilcrow">Â¶</a></p>
<p id="section-4.6-4.1.2">
A client C with public authentication credential AUTH_CRED_C can request two access tokens T1 and T2 from the AS, such that:<a href="#section-4.6-4.1.2" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.6-4.1.3.1">
                <p id="section-4.6-4.1.3.1.1">T1 targets AUD1 and has scope SCOPE1;<a href="#section-4.6-4.1.3.1.1" class="pilcrow">Â¶</a></p>
</li>
              <li class="normal" id="section-4.6-4.1.3.2">
                <p id="section-4.6-4.1.3.2.1">T2 targets AUD2 and has scope SCOPE2 different from SCOPE1.<a href="#section-4.6-4.1.3.2.1" class="pilcrow">Â¶</a></p>
</li>
            </ul>
<p id="section-4.6-4.1.4">
Both T1 and T2 are going to be bound to the same PoP key specified by AUTH_CRED_C.<a href="#section-4.6-4.1.4" class="pilcrow">Â¶</a></p>
<p id="section-4.6-4.1.5">
In fact, if the AS issues access tokens targeting a group-audience, then the above can possibly be the case when using any transport profile of ACE that supports asymmetric PoP keys. If so, the RS should be ready to store at minimum one access token per PoP key per audience it belongs to.<a href="#section-4.6-4.1.5" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-4.6-4.2">
            <p id="section-4.6-4.2.1">The RS is a member of two OSCORE groups G1 and G2. In particular, the same format of public authentication credentials is used in both OSCORE groups.<a href="#section-4.6-4.2.1" class="pilcrow">Â¶</a></p>
<p id="section-4.6-4.2.2">
A client C with public authentication credential AUTH_CRED_C of such format, also member of the two OSCORE group G1 and G2, can conveniently use AUTH_CRED_C as its public authentication credential in both those groups. Therefore, C can request two access tokens T1 and T2 from the AS, such that:<a href="#section-4.6-4.2.2" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.6-4.2.3.1">
                <p id="section-4.6-4.2.3.1.1">T1 targets RS and reflects the membership of C in G1, as per its claims "context_id" and "salt_input";<a href="#section-4.6-4.2.3.1.1" class="pilcrow">Â¶</a></p>
</li>
              <li class="normal" id="section-4.6-4.2.3.2">
                <p id="section-4.6-4.2.3.2.1">T2 targets RS and reflects the membership of C in G2, as per its claims "context_id" and "salt_input".<a href="#section-4.6-4.2.3.2.1" class="pilcrow">Â¶</a></p>
</li>
            </ul>
<p id="section-4.6-4.2.4">
Both T1 and T2 are going to be bound to the same PoP key specified by AUTH_CRED_C.<a href="#section-4.6-4.2.4" class="pilcrow">Â¶</a></p>
<p id="section-4.6-4.2.5">
When using the profile specified in this document, the RS should be ready to store at minimum one access token per PoP key per OSCORE group it is a member of (although, per the previous point, even this can be limiting).<a href="#section-4.6-4.2.5" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-4.6-4.3">
            <p id="section-4.6-4.3.1">The RS uses both the profile specified in this document and a different transport profile of ACE that also relies on asymmetric PoP keys, e.g., the EDHOC and OSCORE profile defined in <span>[<a href="#I-D.ietf-ace-edhoc-oscore-profile" class="cite xref">I-D.ietf-ace-edhoc-oscore-profile</a>]</span>.<a href="#section-4.6-4.3.1" class="pilcrow">Â¶</a></p>
<p id="section-4.6-4.3.2">
In such a case, a client C with public authentication credential AUTH_CRED_C can request two access tokens T1 and T2 from the AS, such that:<a href="#section-4.6-4.3.2" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.6-4.3.3.1">
                <p id="section-4.6-4.3.3.1.1">T1 targets RS and is meant to be used according to the Group OSCORE profile defined in this document;<a href="#section-4.6-4.3.3.1.1" class="pilcrow">Â¶</a></p>
</li>
              <li class="normal" id="section-4.6-4.3.3.2">
                <p id="section-4.6-4.3.3.2.1">T2 targets RS and is meant to be used according to the EDHOC and OSCORE profile defined in <span>[<a href="#I-D.ietf-ace-edhoc-oscore-profile" class="cite xref">I-D.ietf-ace-edhoc-oscore-profile</a>]</span>.<a href="#section-4.6-4.3.3.2.1" class="pilcrow">Â¶</a></p>
</li>
            </ul>
<p id="section-4.6-4.3.4">
Both T1 and T2 are going to be bound to the same PoP key specified by AUTH_CRED_C.<a href="#section-4.6-4.3.4" class="pilcrow">Â¶</a></p>
<p id="section-4.6-4.3.5">
When using multiple transport profiles of ACE that rely on asymmetric PoP keys, it is reasonable that the RS is capable to store at minimum one access token per PoP key per used profile (although, per the previous points, even this can be limiting).<a href="#section-4.6-4.3.5" class="pilcrow">Â¶</a></p>
</li>
        </ul>
<p id="section-4.6-5">In order to keep the same spirit of the recommendation in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.10.1" class="relref">Section 5.10.1</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span> without impeding cases such as those outlined in the examples above, the following defines a more fine-grained recommendations for the storage of access tokens at an RS when this profile is used.<a href="#section-4.6-5" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.6-6.1">
            <p id="section-4.6-6.1.1">As to access tokens issued in accordance with this profile (i.e., specifying the profile "coap_group_oscore"), it is <span class="bcp14">RECOMMENDED</span> that an RS stores only one access token that:<a href="#section-4.6-6.1.1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.6-6.1.2.1">
                <p id="section-4.6-6.1.2.1.1">is bound to a specific PoP key; and<a href="#section-4.6-6.1.2.1.1" class="pilcrow">Â¶</a></p>
</li>
              <li class="normal" id="section-4.6-6.1.2.2">
                <p id="section-4.6-6.1.2.2.1">targets a specific audience; and<a href="#section-4.6-6.1.2.2.1" class="pilcrow">Â¶</a></p>
</li>
              <li class="normal" id="section-4.6-6.1.2.3">
                <p id="section-4.6-6.1.2.3.1">is related to a specific OSCORE group.<a href="#section-4.6-6.1.2.3.1" class="pilcrow">Â¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.6-6.2">
            <p id="section-4.6-6.2.1">As to access tokens issued in accordance with a different profile P that an RS may use in parallel with the profile defined in this document, it is <span class="bcp14">RECOMMENDED</span> that an RS stores only one access token that:<a href="#section-4.6-6.2.1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.6-6.2.2.1">
                <p id="section-4.6-6.2.2.1.1">is issued in accordance with the profile P; and<a href="#section-4.6-6.2.2.1.1" class="pilcrow">Â¶</a></p>
</li>
              <li class="normal" id="section-4.6-6.2.2.2">
                <p id="section-4.6-6.2.2.2.1">is bound to a specific PoP key; and<a href="#section-4.6-6.2.2.2.1" class="pilcrow">Â¶</a></p>
</li>
              <li class="normal" id="section-4.6-6.2.2.3">
                <p id="section-4.6-6.2.2.3.1">targets a specific audience; and<a href="#section-4.6-6.2.2.3.1" class="pilcrow">Â¶</a></p>
</li>
              <li class="normal" id="section-4.6-6.2.2.4">
                <p id="section-4.6-6.2.2.4.1">is related to a specific secure association used by the client to protect communications with the RS.<a href="#section-4.6-6.2.2.4.1" class="pilcrow">Â¶</a></p>
</li>
            </ul>
</li>
        </ul>
<p id="section-4.6-7">In accordance with these recommendations, if an access token T_NEW does not differ in any of the respects above from an existing access token T_OLD stored at the RS, then T_NEW will supersede T_OLD by replacing the corresponding authorization information.<a href="#section-4.6-7" class="pilcrow">Â¶</a></p>
<p id="section-4.6-8">Not complying with these recommendations can additionally complicate (constrained) implementations of RSs, with respect to required storage and the validation of a protected request against the applicable, stored access tokens associated with the same client. That is, it increases the strain on an RS in determining the actual permissions of a client, e.g., if access tokens contradict each other and thus might lead the RS to enforce wrong permissions. Moreover, if one of the access tokens expires earlier than others, the resulting permissions may offer insufficient protection.<a href="#section-4.6-8" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-client-public-key-change">
<section id="section-5">
      <h2 id="name-change-of-clients-authentic">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-change-of-clients-authentic" class="section-name selfRef">Change of Client's Authentication Credential in the Group</a>
      </h2>
<p id="section-5-1">During its membership in the OSCORE group, the client might change the authentication credential that it uses in the group. When this happens, the client uploads the new authentication credential to the Group Manager, as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-oscore-16#section-9.4" class="relref">Section 9.4</a> of [<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="cite xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>.<a href="#section-5-1" class="pilcrow">Â¶</a></p>
<p id="section-5-2">After that, and in order to continue communicating with the RS, the client <span class="bcp14">MUST</span> perform the following actions.<a href="#section-5-2" class="pilcrow">Â¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5-3">
<li id="section-5-3.1">
          <p id="section-5-3.1.1">The client requests a new access token to the AS, as defined in <a href="#sec-c-as-comm" class="auto internal xref">Section 3</a>. In particular, when sending the Access Token Request as defined in <a href="#sec-c-as-token-endpoint" class="auto internal xref">Section 3.1</a>, the client specifies:<a href="#section-5-3.1.1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-3.1.2.1">
              <p id="section-5-3.1.2.1.1">The current Group Identifier of the OSCORE group, as value of the 'context_id' parameter.<a href="#section-5-3.1.2.1.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-5-3.1.2.2">
              <p id="section-5-3.1.2.2.1">The current Sender ID that it has in the OSCORE group, as value of the 'salt_input' parameter.<a href="#section-5-3.1.2.2.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-5-3.1.2.3">
              <p id="section-5-3.1.2.3.1">The new authentication credential that it uses in the OSCORE group, as inner confirmation value of the 'req_cnf' parameter.<a href="#section-5-3.1.2.3.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-5-3.1.2.4">
              <p id="section-5-3.1.2.4.1">The proof-of-possession (PoP) evidence corresponding to the public key of the new authentication credential, as value of the 'client_cred_verify' or 'client_cred_verify_mac' parameter.<a href="#section-5-3.1.2.4.1" class="pilcrow">Â¶</a></p>
</li>
          </ul>
</li>
        <li id="section-5-3.2">
          <p id="section-5-3.2.1">After receiving the Access Token Response from the AS (see <a href="#sec-as-c-token" class="auto internal xref">Section 3.2</a>), the client performs the same exchanges with the RS as defined in <a href="#sec-c-rs-comm" class="auto internal xref">Section 4</a>.<a href="#section-5-3.2.1" class="pilcrow">Â¶</a></p>
</li>
      </ol>
<p id="section-5-4">When receiving the new access token, the RS performs the same steps defined in <a href="#sec-rs-c-created" class="auto internal xref">Section 4.2</a>, with the following addition in case the new access token is successfully verified and stored:<a href="#section-5-4" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-5.1">
          <p id="section-5-5.1.1">The RS also deletes the old access token, i.e., the one whose associated triple (GID, SaltInput, AuthCred) has the same GID and SaltInput values as in the triple that is associated with the new access token and that includes the new authentication credential of the client.<a href="#section-5-5.1.1" class="pilcrow">Â¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="sec-comm-as">
<section id="section-6">
      <h2 id="name-secure-communication-with-t">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-secure-communication-with-t" class="section-name selfRef">Secure Communication with the AS</a>
      </h2>
<p id="section-6-1">As specified in the ACE framework (see Sections <a href="https://rfc-editor.org/rfc/rfc9200#section-5.8" class="relref">5.8</a> and <a href="https://rfc-editor.org/rfc/rfc9200#section-5.9" class="relref">5.9</a> of <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>), the requesting entity (client and/or RS) and the AS communicate via the /token or /introspect endpoint. The use of CoAP and OSCORE <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span> for this communication is <span class="bcp14">RECOMMENDED</span> in this profile. Other protocols fulfilling the security requirements defined in Sections <a href="https://rfc-editor.org/rfc/rfc9200#section-5" class="relref">5</a> and <a href="https://rfc-editor.org/rfc/rfc9200#section-6" class="relref">6</a> of <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span> (such as HTTP and DTLS or TLS) <span class="bcp14">MAY</span> be used instead.<a href="#section-6-1" class="pilcrow">Â¶</a></p>
<p id="section-6-2">If OSCORE <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span> is used, the requesting entity and the AS are expected to have a pre-established Security Context in place. How this Security Context is established is out of the scope of this profile. Furthermore, the requesting entity and the AS communicate using OSCORE through the /token endpoint as specified in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8" class="relref">Section 5.8</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>, and through the /introspect endpoint as specified in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.9" class="relref">Section 5.9</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>.<a href="#section-6-2" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="sec-discard-context">
<section id="section-7">
      <h2 id="name-discarding-the-security-con">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-discarding-the-security-con" class="section-name selfRef">Discarding the Security Context</a>
      </h2>
<p id="section-7-1">As members of an OSCORE group, the client and the RS may independently leave the group or be forced to, e.g., if compromised or suspected so. Upon leaving the OSCORE group, the client or RS also discards the Group OSCORE Security Context, which may anyway be renewed by the Group Manager through a group rekeying process (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-12.2" class="relref">Section 12.2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>).<a href="#section-7-1" class="pilcrow">Â¶</a></p>
<p id="section-7-2">The client or RS can acquire a new Group OSCORE Security Context, by re-joining the OSCORE group, e.g., by using the approach defined in <span>[<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="cite xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>. In such a case, the client <span class="bcp14">SHOULD</span> request a new access token to be uploaded to the RS.<a href="#section-7-2" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="sec-cbor-mappings">
<section id="section-8">
      <h2 id="name-cbor-mappings">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-cbor-mappings" class="section-name selfRef">CBOR Mappings</a>
      </h2>
<p id="section-8-1">The new parameters defined in this document <span class="bcp14">MUST</span> be mapped to CBOR types as specified in <a href="#_table-cbor-mappings-parameters" class="auto internal xref">Table 1</a>, using the given integer abbreviation for the map key.<a href="#section-8-1" class="pilcrow">Â¶</a></p>
<span id="name-cbor-mappings-for-new-param"></span><div id="_table-cbor-mappings-parameters">
<table class="center" id="table-1">
        <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-cbor-mappings-for-new-param" class="selfRef">CBOR Mappings for New Parameters.</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Parameter name</th>
            <th class="text-left" rowspan="1" colspan="1">CBOR Key</th>
            <th class="text-left" rowspan="1" colspan="1">Value Type</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">context_id</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
            <td class="text-left" rowspan="1" colspan="1">byte string</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">salt_input</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
            <td class="text-left" rowspan="1" colspan="1">byte string</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">client_cred_verify</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
            <td class="text-left" rowspan="1" colspan="1">byte string</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">client_cred_verify_mac</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
            <td class="text-left" rowspan="1" colspan="1">byte string</td>
          </tr>
        </tbody>
      </table>
</div>
<p id="section-8-3">The new claims defined in this document <span class="bcp14">MUST</span> be mapped to CBOR types as specified in <a href="#_table-cbor-mappings-claims" class="auto internal xref">Table 2</a>, using the given integer abbreviation for the map key.<a href="#section-8-3" class="pilcrow">Â¶</a></p>
<span id="name-cbor-mappings-for-new-claim"></span><div id="_table-cbor-mappings-claims">
<table class="center" id="table-2">
        <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-cbor-mappings-for-new-claim" class="selfRef">CBOR Mappings for New Claims.</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Claim name</th>
            <th class="text-left" rowspan="1" colspan="1">CBOR Key</th>
            <th class="text-left" rowspan="1" colspan="1">Value Type</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">context_id</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
            <td class="text-left" rowspan="1" colspan="1">byte string</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">salt_input</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
            <td class="text-left" rowspan="1" colspan="1">byte string</td>
          </tr>
        </tbody>
      </table>
</div>
</section>
</div>
<div id="sec-security-considerations">
<section id="section-9">
      <h2 id="name-security-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-9-1">This document specifies a profile for the Authentication and Authorization for Constrained Environments (ACE) framework <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>. Thus, the general security considerations from the ACE framework also apply to this profile.<a href="#section-9-1" class="pilcrow">Â¶</a></p>
<p id="section-9-2">The proof-of-possession (PoP) key bound to an access token is always an asymmetric key, i.e., the public key included in the authentication credential that the client uses in the OSCORE group. This means that there is never a same shared secret used as PoP key with possible multiple RSs. Therefore, it is possible and safe for the AS to issue an access token for an audience that includes multiple RSs (i.e., a group-audience, see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-6.9" class="relref">Section 6.9</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>).<a href="#section-9-2" class="pilcrow">Â¶</a></p>
<p id="section-9-3">In such a case, as per <span><a href="https://rfc-editor.org/rfc/rfc9200#section-6.1" class="relref">Section 6.1</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>, the AS has to ensure the integrity protection of the access token by protecting it through an asymmetric signature. In addition, the used group-audience has to correctly identify all the RSs that are intended recipients of the access token, and for which the single scope specified in the access token applies. As a particular case, the audience can be the name of the OSCORE group, if the access token is intended for all the RSs in that group.<a href="#section-9-3" class="pilcrow">Â¶</a></p>
<p id="section-9-4">Furthermore, this document inherits the general security considerations about Group OSCORE <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, as to the specific use of Group OSCORE according to this profile.<a href="#section-9-4" class="pilcrow">Â¶</a></p>
<p id="section-9-5">Group OSCORE is designed to secure point-to-point as well as point-to-multipoint communications, providing a secure binding between a single request and multiple corresponding responses. In particular, Group OSCORE fulfills the same security requirements of OSCORE.<a href="#section-9-5" class="pilcrow">Â¶</a></p>
<p id="section-9-6">Group OSCORE ensures source authentication of messages both in group mode (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-7" class="relref">Section 7</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>) and in pairwise mode (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-8" class="relref">Section 8</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>).<a href="#section-9-6" class="pilcrow">Â¶</a></p>
<p id="section-9-7">When protecting an outgoing message in group mode, the sender uses its private key to compute a digital signature, which is embedded in the protected message. The group mode can be used to protect messages sent to multiple recipients (e.g., over IP multicast) or to a single recipient.<a href="#section-9-7" class="pilcrow">Â¶</a></p>
<p id="section-9-8">When protecting an outgoing message in pairwise mode, the sender uses a pairwise symmetric key, which is derived from the asymmetric keys of the two peers exchanging the message. The pairwise mode can be used to protect only messages intended for a single recipient.<a href="#section-9-8" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="sec-privacy-considerations">
<section id="section-10">
      <h2 id="name-privacy-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-10-1">This document specifies a profile for the Authentication and Authorization for Constrained Environments (ACE) framework <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>. Thus the general privacy considerations from the ACE framework also apply to this profile.<a href="#section-10-1" class="pilcrow">Â¶</a></p>
<p id="section-10-2">As this profile uses Group OSCORE, the privacy considerations from <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span> apply to this document as well.<a href="#section-10-2" class="pilcrow">Â¶</a></p>
<p id="section-10-3">An unprotected response to an unauthorized request may disclose information about the RS and/or its existing relationship with the client. It is advisable to include as little information as possible in an unencrypted response. However, since both the client and the RS share a Group OSCORE Security Context, unauthorized, yet protected requests are followed by protected responses, which can thus include more detailed information.<a href="#section-10-3" class="pilcrow">Â¶</a></p>
<p id="section-10-4">Although it may be encrypted, the access token is sent in the clear to the /authz-info endpoint at the RS. Thus, if the client uses the same single access token from multiple locations with multiple resource servers, it can risk being tracked through the access token's value.<a href="#section-10-4" class="pilcrow">Â¶</a></p>
<p id="section-10-5">Note that, even though communications are protected with Group OSCORE, some information might still leak, due to the observable size, source address, and destination address of exchanged messages.<a href="#section-10-5" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="iana">
<section id="section-11">
      <h2 id="name-iana-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-11-1">This document has the following actions for IANA.<a href="#section-11-1" class="pilcrow">Â¶</a></p>
<p id="section-11-2">Note to RFC Editor: Please replace "[RFC-XXXX]" with the RFC number of this document and delete this paragraph.<a href="#section-11-2" class="pilcrow">Â¶</a></p>
<div id="iana-ace-oauth-profile">
<section id="section-11.1">
        <h3 id="name-ace-profiles-registry">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-ace-profiles-registry" class="section-name selfRef">ACE Profiles Registry</a>
        </h3>
<p id="section-11.1-1">IANA is asked to add the following entry to the "ACE Profiles" registry within the "Authentication and Authorization for Constrained Environments (ACE)" registry group, following the procedure specified in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-8.8" class="relref">Section 8.8</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>.<a href="#section-11.1-1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.1-2.1">
            <p id="section-11.1-2.1.1">Name: coap_group_oscore<a href="#section-11.1-2.1.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.1-2.2">
            <p id="section-11.1-2.2.1">Description: Profile to secure communications between constrained nodes using the Authentication and Authorization for Constrained Environments framework, by enabling authentication and fine-grained authorization of members of an OSCORE group that use a pre-established Group OSCORE Security Context to communicate with Group OSCORE.<a href="#section-11.1-2.2.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.1-2.3">
            <p id="section-11.1-2.3.1">CBOR Value: TBD (value between 1 and 255)<a href="#section-11.1-2.3.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.1-2.4">
            <p id="section-11.1-2.4.1">Reference: [RFC-XXXX]<a href="#section-11.1-2.4.1" class="pilcrow">Â¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="iana-oauth-params">
<section id="section-11.2">
        <h3 id="name-oauth-parameters-registry">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-oauth-parameters-registry" class="section-name selfRef">OAuth Parameters Registry</a>
        </h3>
<p id="section-11.2-1">IANA is asked to add the following entries to the "OAuth Parameters" registry, following the procedure specified in <span><a href="https://rfc-editor.org/rfc/rfc6749#section-11.2" class="relref">Section 11.2</a> of [<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-11.2-1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.2-2.1">
            <p id="section-11.2-2.1.1">Name: context_id<a href="#section-11.2-2.1.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.2-2.2">
            <p id="section-11.2-2.2.1">Parameter Usage Location: token request<a href="#section-11.2-2.2.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.2-2.3">
            <p id="section-11.2-2.3.1">Change Controller: IETF<a href="#section-11.2-2.3.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.2-2.4">
            <p id="section-11.2-2.4.1">Reference: <a href="#context_id" class="auto internal xref">Section 3.1.1</a> of [RFC-XXXX]<a href="#section-11.2-2.4.1" class="pilcrow">Â¶</a></p>
</li>
        </ul>
<p id="section-11.2-3"><br></p>
<ul class="normal">
<li class="normal" id="section-11.2-4.1">
            <p id="section-11.2-4.1.1">Name: salt_input<a href="#section-11.2-4.1.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.2-4.2">
            <p id="section-11.2-4.2.1">Parameter Usage Location: token request<a href="#section-11.2-4.2.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.2-4.3">
            <p id="section-11.2-4.3.1">Change Controller: IETF<a href="#section-11.2-4.3.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.2-4.4">
            <p id="section-11.2-4.4.1">Reference: <a href="#salt_input" class="auto internal xref">Section 3.1.2</a> of [RFC-XXXX]<a href="#section-11.2-4.4.1" class="pilcrow">Â¶</a></p>
</li>
        </ul>
<p id="section-11.2-5"><br></p>
<ul class="normal">
<li class="normal" id="section-11.2-6.1">
            <p id="section-11.2-6.1.1">Name: client_cred_verify<a href="#section-11.2-6.1.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.2-6.2">
            <p id="section-11.2-6.2.1">Parameter Usage Location: token request<a href="#section-11.2-6.2.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.2-6.3">
            <p id="section-11.2-6.3.1">Change Controller: IETF<a href="#section-11.2-6.3.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.2-6.4">
            <p id="section-11.2-6.4.1">Reference: <a href="#client_cred_verify" class="auto internal xref">Section 3.1.3</a> of [RFC-XXXX]<a href="#section-11.2-6.4.1" class="pilcrow">Â¶</a></p>
</li>
        </ul>
<p id="section-11.2-7"><br></p>
<ul class="normal">
<li class="normal" id="section-11.2-8.1">
            <p id="section-11.2-8.1.1">Name: client_cred_verify_mac<a href="#section-11.2-8.1.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.2-8.2">
            <p id="section-11.2-8.2.1">Parameter Usage Location: token request<a href="#section-11.2-8.2.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.2-8.3">
            <p id="section-11.2-8.3.1">Change Controller: IETF<a href="#section-11.2-8.3.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.2-8.4">
            <p id="section-11.2-8.4.1">Reference: <a href="#client_cred_verify_mac" class="auto internal xref">Section 3.1.4</a> of [RFC-XXXX]<a href="#section-11.2-8.4.1" class="pilcrow">Â¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="iana-token-cbor-mappings">
<section id="section-11.3">
        <h3 id="name-oauth-parameters-cbor-mappi">
<a href="#section-11.3" class="section-number selfRef">11.3. </a><a href="#name-oauth-parameters-cbor-mappi" class="section-name selfRef">OAuth Parameters CBOR Mappings Registry</a>
        </h3>
<p id="section-11.3-1">IANA is asked to add the following entries to the "OAuth Parameters CBOR Mappings" registry within the "Authentication and Authorization for Constrained Environments (ACE)" registry group, following the procedure specified in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-8.10" class="relref">Section 8.10</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>.<a href="#section-11.3-1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.3-2.1">
            <p id="section-11.3-2.1.1">Name: context_id<a href="#section-11.3-2.1.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.3-2.2">
            <p id="section-11.3-2.2.1">CBOR Key: TBD<a href="#section-11.3-2.2.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.3-2.3">
            <p id="section-11.3-2.3.1">Value Type: byte string<a href="#section-11.3-2.3.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.3-2.4">
            <p id="section-11.3-2.4.1">Reference: <a href="#context_id" class="auto internal xref">Section 3.1.1</a> of [RFC-XXXX]<a href="#section-11.3-2.4.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.3-2.5">
            <p id="section-11.3-2.5.1">Original Specification: [RFC-XXXX]<a href="#section-11.3-2.5.1" class="pilcrow">Â¶</a></p>
</li>
        </ul>
<p id="section-11.3-3"><br></p>
<ul class="normal">
<li class="normal" id="section-11.3-4.1">
            <p id="section-11.3-4.1.1">Name: salt_input<a href="#section-11.3-4.1.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.3-4.2">
            <p id="section-11.3-4.2.1">CBOR Key: TBD<a href="#section-11.3-4.2.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.3-4.3">
            <p id="section-11.3-4.3.1">Value Type: byte string<a href="#section-11.3-4.3.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.3-4.4">
            <p id="section-11.3-4.4.1">Reference: <a href="#salt_input" class="auto internal xref">Section 3.1.2</a> of [RFC-XXXX]<a href="#section-11.3-4.4.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.3-4.5">
            <p id="section-11.3-4.5.1">Original Specification: [RFC-XXXX]<a href="#section-11.3-4.5.1" class="pilcrow">Â¶</a></p>
</li>
        </ul>
<p id="section-11.3-5"><br></p>
<ul class="normal">
<li class="normal" id="section-11.3-6.1">
            <p id="section-11.3-6.1.1">Name: client_cred_verify<a href="#section-11.3-6.1.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.3-6.2">
            <p id="section-11.3-6.2.1">CBOR Key: TBD<a href="#section-11.3-6.2.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.3-6.3">
            <p id="section-11.3-6.3.1">Value Type: byte string<a href="#section-11.3-6.3.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.3-6.4">
            <p id="section-11.3-6.4.1">Reference: <a href="#client_cred_verify" class="auto internal xref">Section 3.1.3</a> of [RFC-XXXX]<a href="#section-11.3-6.4.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.3-6.5">
            <p id="section-11.3-6.5.1">Original Specification: [RFC-XXXX]<a href="#section-11.3-6.5.1" class="pilcrow">Â¶</a></p>
</li>
        </ul>
<p id="section-11.3-7"><br></p>
<ul class="normal">
<li class="normal" id="section-11.3-8.1">
            <p id="section-11.3-8.1.1">Name: client_cred_verify_mac<a href="#section-11.3-8.1.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.3-8.2">
            <p id="section-11.3-8.2.1">CBOR Key: TBD<a href="#section-11.3-8.2.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.3-8.3">
            <p id="section-11.3-8.3.1">Value Type: byte string<a href="#section-11.3-8.3.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.3-8.4">
            <p id="section-11.3-8.4.1">Reference: <a href="#client_cred_verify_mac" class="auto internal xref">Section 3.1.4</a> of [RFC-XXXX]<a href="#section-11.3-8.4.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.3-8.5">
            <p id="section-11.3-8.5.1">Original Specification: [RFC-XXXX]<a href="#section-11.3-8.5.1" class="pilcrow">Â¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="iana-token-cwt-claims">
<section id="section-11.4">
        <h3 id="name-cbor-web-token-cwt-claims-r">
<a href="#section-11.4" class="section-number selfRef">11.4. </a><a href="#name-cbor-web-token-cwt-claims-r" class="section-name selfRef">CBOR Web Token (CWT) Claims Registry</a>
        </h3>
<p id="section-11.4-1">IANA is asked to add the following entries to the "CBOR Web Token (CWT) Claims" registry, following the procedure specified in <span><a href="https://rfc-editor.org/rfc/rfc8392#section-9.1" class="relref">Section 9.1</a> of [<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>.<a href="#section-11.4-1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.4-2.1">
            <p id="section-11.4-2.1.1">Claim Name: context_id<a href="#section-11.4-2.1.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.4-2.2">
            <p id="section-11.4-2.2.1">Claim Description: Client provided Context ID<a href="#section-11.4-2.2.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.4-2.3">
            <p id="section-11.4-2.3.1">JWT Claim Name: N/A<a href="#section-11.4-2.3.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.4-2.4">
            <p id="section-11.4-2.4.1">Claim Key: TBD<a href="#section-11.4-2.4.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.4-2.5">
            <p id="section-11.4-2.5.1">Claim Value Type: byte string<a href="#section-11.4-2.5.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.4-2.6">
            <p id="section-11.4-2.6.1">Change Controller: IETF<a href="#section-11.4-2.6.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.4-2.7">
            <p id="section-11.4-2.7.1">Reference: <a href="#context_id_claim" class="auto internal xref">Section 3.2.2</a> of [RFC-XXXX]<a href="#section-11.4-2.7.1" class="pilcrow">Â¶</a></p>
</li>
        </ul>
<p id="section-11.4-3"><br></p>
<ul class="normal">
<li class="normal" id="section-11.4-4.1">
            <p id="section-11.4-4.1.1">Claim Name: salt_input<a href="#section-11.4-4.1.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.4-4.2">
            <p id="section-11.4-4.2.1">Claim Description: Client provided salt input<a href="#section-11.4-4.2.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.4-4.3">
            <p id="section-11.4-4.3.1">JWT Claim Name: N/A<a href="#section-11.4-4.3.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.4-4.4">
            <p id="section-11.4-4.4.1">Claim Key: TBD<a href="#section-11.4-4.4.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.4-4.5">
            <p id="section-11.4-4.5.1">Claim Value Type: byte string<a href="#section-11.4-4.5.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.4-4.6">
            <p id="section-11.4-4.6.1">Change Controller: IETF<a href="#section-11.4-4.6.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.4-4.7">
            <p id="section-11.4-4.7.1">Reference: <a href="#salt_input_claim" class="auto internal xref">Section 3.2.3</a> of [RFC-XXXX]<a href="#section-11.4-4.7.1" class="pilcrow">Â¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="iana-tls-exporter-label">
<section id="section-11.5">
        <h3 id="name-tls-exporter-label-registry">
<a href="#section-11.5" class="section-number selfRef">11.5. </a><a href="#name-tls-exporter-label-registry" class="section-name selfRef">TLS Exporter Label Registry</a>
        </h3>
<p id="section-11.5-1">IANA is asked to add the following entry to the "TLS Exporter Label" registry within the "Transport Layer Security (TLS) Parameters" registry group, following the procedure specified in <span><a href="https://rfc-editor.org/rfc/rfc5705#section-6" class="relref">Section 6</a> of [<a href="#RFC5705" class="cite xref">RFC5705</a>]</span> and updated in <span><a href="https://rfc-editor.org/rfc/rfc8447#section-12" class="relref">Section 12</a> of [<a href="#RFC8447" class="cite xref">RFC8447</a>]</span>.<a href="#section-11.5-1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.5-2.1">
            <p id="section-11.5-2.1.1">Value: EXPORTER-ACE-PoP-Input-Client-AS<a href="#section-11.5-2.1.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.5-2.2">
            <p id="section-11.5-2.2.1">DTLS-OK: Y<a href="#section-11.5-2.2.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.5-2.3">
            <p id="section-11.5-2.3.1">Recommended: N<a href="#section-11.5-2.3.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-11.5-2.4">
            <p id="section-11.5-2.4.1">Reference: <a href="#sec-c-as-token-endpoint" class="auto internal xref">Section 3.1</a> of [RFC-XXXX]<a href="#section-11.5-2.4.1" class="pilcrow">Â¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-12">
      <h2 id="name-references">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-12.1">
        <h3 id="name-normative-references">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-ace-key-groupcomm-oscore">[I-D.ietf-ace-key-groupcomm-oscore]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">Park, J.</span>, and <span class="refAuthor">F. Palombini</span>, <span class="refTitle">"Key Management for OSCORE Groups in ACE"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-key-groupcomm-oscore-16</span>, <time datetime="2023-03-06" class="refDate">6 March 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-oscore-16">https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-oscore-16</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-groupcomm-bis">[I-D.ietf-core-groupcomm-bis]</dt>
        <dd>
<span class="refAuthor">Dijk, E.</span>, <span class="refAuthor">Wang, C.</span>, and <span class="refAuthor">M. Tiloca</span>, <span class="refTitle">"Group Communication for the Constrained Application Protocol (CoAP)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-groupcomm-bis-11</span>, <time datetime="2024-04-24" class="refDate">24 April 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-groupcomm-bis-11">https://datatracker.ietf.org/doc/html/draft-ietf-core-groupcomm-bis-11</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-oscore-groupcomm">[I-D.ietf-core-oscore-groupcomm]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Palombini, F.</span>, <span class="refAuthor">Mattsson, J. P.</span>, and <span class="refAuthor">R. HÃ¶glund</span>, <span class="refTitle">"Group Object Security for Constrained RESTful Environments (Group OSCORE)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-oscore-groupcomm-23</span>, <time datetime="2024-09-26" class="refDate">26 September 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23">https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NIST-800-56A">[NIST-800-56A]</dt>
        <dd>
<span class="refAuthor">Barker, E.</span>, <span class="refAuthor">Chen, L.</span>, <span class="refAuthor">Roginsky, A.</span>, <span class="refAuthor">Vassilev, A.</span>, and <span class="refAuthor">R. Davis</span>, <span class="refTitle">"Recommendation for Pair-Wise Key-Establishment Schemes Using Discrete Logarithm Cryptography - NIST Special Publication 800-56A, Revision 3"</span>, <time datetime="2018-04" class="refDate">April 2018</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-56Ar3.pdf">https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-56Ar3.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5246">[RFC5246]</dt>
        <dd>
<span class="refAuthor">Dierks, T.</span> and <span class="refAuthor">E. Rescorla</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.2"</span>, <span class="seriesInfo">RFC 5246</span>, <span class="seriesInfo">DOI 10.17487/RFC5246</span>, <time datetime="2008-08" class="refDate">August 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5246">https://www.rfc-editor.org/rfc/rfc5246</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5705">[RFC5705]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"Keying Material Exporters for Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 5705</span>, <span class="seriesInfo">DOI 10.17487/RFC5705</span>, <time datetime="2010-03" class="refDate">March 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5705">https://www.rfc-editor.org/rfc/rfc5705</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5869">[RFC5869]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span> and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"HMAC-based Extract-and-Expand Key Derivation Function (HKDF)"</span>, <span class="seriesInfo">RFC 5869</span>, <span class="seriesInfo">DOI 10.17487/RFC5869</span>, <time datetime="2010-05" class="refDate">May 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5869">https://www.rfc-editor.org/rfc/rfc5869</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6347">[RFC6347]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span> and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"Datagram Transport Layer Security Version 1.2"</span>, <span class="seriesInfo">RFC 6347</span>, <span class="seriesInfo">DOI 10.17487/RFC6347</span>, <time datetime="2012-01" class="refDate">January 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6347">https://www.rfc-editor.org/rfc/rfc6347</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6749">[RFC6749]</dt>
        <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6749">https://www.rfc-editor.org/rfc/rfc6749</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7252">[RFC7252]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7252">https://www.rfc-editor.org/rfc/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7748">[RFC7748]</dt>
        <dd>
<span class="refAuthor">Langley, A.</span>, <span class="refAuthor">Hamburg, M.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Elliptic Curves for Security"</span>, <span class="seriesInfo">RFC 7748</span>, <span class="seriesInfo">DOI 10.17487/RFC7748</span>, <time datetime="2016-01" class="refDate">January 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7748">https://www.rfc-editor.org/rfc/rfc7748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8392">[RFC8392]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"CBOR Web Token (CWT)"</span>, <span class="seriesInfo">RFC 8392</span>, <span class="seriesInfo">DOI 10.17487/RFC8392</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8392">https://www.rfc-editor.org/rfc/rfc8392</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8447">[RFC8447]</dt>
        <dd>
<span class="refAuthor">Salowey, J.</span> and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"IANA Registry Updates for TLS and DTLS"</span>, <span class="seriesInfo">RFC 8447</span>, <span class="seriesInfo">DOI 10.17487/RFC8447</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8447">https://www.rfc-editor.org/rfc/rfc8447</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8610">[RFC8610]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Vigano, C.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures"</span>, <span class="seriesInfo">RFC 8610</span>, <span class="seriesInfo">DOI 10.17487/RFC8610</span>, <time datetime="2019-06" class="refDate">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8610">https://www.rfc-editor.org/rfc/rfc8610</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8613">[RFC8613]</dt>
        <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Mattsson, J.</span>, <span class="refAuthor">Palombini, F.</span>, and <span class="refAuthor">L. Seitz</span>, <span class="refTitle">"Object Security for Constrained RESTful Environments (OSCORE)"</span>, <span class="seriesInfo">RFC 8613</span>, <span class="seriesInfo">DOI 10.17487/RFC8613</span>, <time datetime="2019-07" class="refDate">July 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8613">https://www.rfc-editor.org/rfc/rfc8613</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8747">[RFC8747]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Proof-of-Possession Key Semantics for CBOR Web Tokens (CWTs)"</span>, <span class="seriesInfo">RFC 8747</span>, <span class="seriesInfo">DOI 10.17487/RFC8747</span>, <time datetime="2020-03" class="refDate">March 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8747">https://www.rfc-editor.org/rfc/rfc8747</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8949">[RFC8949]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8949">https://www.rfc-editor.org/rfc/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9052">[RFC9052]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Structures and Process"</span>, <span class="seriesInfo">STD 96</span>, <span class="seriesInfo">RFC 9052</span>, <span class="seriesInfo">DOI 10.17487/RFC9052</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9052">https://www.rfc-editor.org/rfc/rfc9052</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9053">[RFC9053]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Initial Algorithms"</span>, <span class="seriesInfo">RFC 9053</span>, <span class="seriesInfo">DOI 10.17487/RFC9053</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9053">https://www.rfc-editor.org/rfc/rfc9053</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9200">[RFC9200]</dt>
        <dd>
<span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Authentication and Authorization for Constrained Environments Using the OAuth 2.0 Framework (ACE-OAuth)"</span>, <span class="seriesInfo">RFC 9200</span>, <span class="seriesInfo">DOI 10.17487/RFC9200</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9200">https://www.rfc-editor.org/rfc/rfc9200</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9201">[RFC9201]</dt>
        <dd>
<span class="refAuthor">Seitz, L.</span>, <span class="refTitle">"Additional OAuth Parameters for Authentication and Authorization for Constrained Environments (ACE)"</span>, <span class="seriesInfo">RFC 9201</span>, <span class="seriesInfo">DOI 10.17487/RFC9201</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9201">https://www.rfc-editor.org/rfc/rfc9201</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9203">[RFC9203]</dt>
      <dd>
<span class="refAuthor">Palombini, F.</span>, <span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, and <span class="refAuthor">M. Gunnarsson</span>, <span class="refTitle">"The Object Security for Constrained RESTful Environments (OSCORE) Profile of the Authentication and Authorization for Constrained Environments (ACE) Framework"</span>, <span class="seriesInfo">RFC 9203</span>, <span class="seriesInfo">DOI 10.17487/RFC9203</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9203">https://www.rfc-editor.org/rfc/rfc9203</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-12.2">
        <h3 id="name-informative-references">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-ace-edhoc-oscore-profile">[I-D.ietf-ace-edhoc-oscore-profile]</dt>
        <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Mattsson, J. P.</span>, <span class="refAuthor">Tiloca, M.</span>, and <span class="refAuthor">R. HÃ¶glund</span>, <span class="refTitle">"Ephemeral Diffie-Hellman Over COSE (EDHOC) and Object Security for Constrained Environments (OSCORE) Profile for Authentication and Authorization for Constrained Environments (ACE)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-edhoc-oscore-profile-05</span>, <time datetime="2024-07-08" class="refDate">8 July 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-edhoc-oscore-profile-05">https://datatracker.ietf.org/doc/html/draft-ietf-ace-edhoc-oscore-profile-05</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ace-workflow-and-params">[I-D.ietf-ace-workflow-and-params]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span> and <span class="refAuthor">G. Selander</span>, <span class="refTitle">"Alternative Workflow and OAuth Parameters for the Authentication and Authorization for Constrained Environments (ACE) Framework"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-workflow-and-params-02</span>, <time datetime="2024-07-08" class="refDate">8 July 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-workflow-and-params-02">https://datatracker.ietf.org/doc/html/draft-ietf-ace-workflow-and-params-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-cose-cbor-encoded-cert">[I-D.ietf-cose-cbor-encoded-cert]</dt>
        <dd>
<span class="refAuthor">Mattsson, J. P.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Raza, S.</span>, <span class="refAuthor">HÃ¶glund, J.</span>, and <span class="refAuthor">M. Furuhed</span>, <span class="refTitle">"CBOR Encoded X.509 Certificates (C509 Certificates)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cose-cbor-encoded-cert-11</span>, <time datetime="2024-07-08" class="refDate">8 July 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-cose-cbor-encoded-cert-11">https://datatracker.ietf.org/doc/html/draft-ietf-cose-cbor-encoded-cert-11</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.tiloca-core-oscore-discovery">[I-D.tiloca-core-oscore-discovery]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">AmsÃ¼ss, C.</span>, and <span class="refAuthor">P. Van der Stok</span>, <span class="refTitle">"Discovery of OSCORE Groups with the CoRE Resource Directory"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-tiloca-core-oscore-discovery-16</span>, <time datetime="2024-09-04" class="refDate">4 September 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-tiloca-core-oscore-discovery-16">https://datatracker.ietf.org/doc/html/draft-tiloca-core-oscore-discovery-16</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NIST-800-207">[NIST-800-207]</dt>
        <dd>
<span class="refAuthor">Rose, S.</span>, <span class="refAuthor">Borchert, O.</span>, <span class="refAuthor">Mitchell, S.</span>, and <span class="refAuthor">S. Connelly</span>, <span class="refTitle">"Zero Trust Architecture - NIST Special Publication 800-207"</span>, <time datetime="2020-08" class="refDate">August 2020</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-207.pdf">https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-207.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9147">[RFC9147]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"The Datagram Transport Layer Security (DTLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 9147</span>, <span class="seriesInfo">DOI 10.17487/RFC9147</span>, <time datetime="2022-04" class="refDate">April 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9147">https://www.rfc-editor.org/rfc/rfc9147</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9202">[RFC9202]</dt>
        <dd>
<span class="refAuthor">Gerdes, S.</span>, <span class="refAuthor">Bergmann, O.</span>, <span class="refAuthor">Bormann, C.</span>, <span class="refAuthor">Selander, G.</span>, and <span class="refAuthor">L. Seitz</span>, <span class="refTitle">"Datagram Transport Layer Security (DTLS) Profile for Authentication and Authorization for Constrained Environments (ACE)"</span>, <span class="seriesInfo">RFC 9202</span>, <span class="seriesInfo">DOI 10.17487/RFC9202</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9202">https://www.rfc-editor.org/rfc/rfc9202</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9431">[RFC9431]</dt>
      <dd>
<span class="refAuthor">Sengul, C.</span> and <span class="refAuthor">A. Kirby</span>, <span class="refTitle">"Message Queuing Telemetry Transport (MQTT) and Transport Layer Security (TLS) Profile of Authentication and Authorization for Constrained Environments (ACE) Framework"</span>, <span class="seriesInfo">RFC 9431</span>, <span class="seriesInfo">DOI 10.17487/RFC9431</span>, <time datetime="2023-07" class="refDate">July 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9431">https://www.rfc-editor.org/rfc/rfc9431</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="profile-requirements">
<section id="appendix-A">
      <h2 id="name-profile-requirements">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-profile-requirements" class="section-name selfRef">Profile Requirements</a>
      </h2>
<p id="appendix-A-1">This appendix lists the specifications of this profile based on the requirements of the ACE framework, as requested in <span><a href="https://rfc-editor.org/rfc/rfc9200#appendix-C" class="relref">Appendix C</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>.<a href="#appendix-A-1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-2.1">
          <p id="appendix-A-2.1.1">Optionally, define new methods for the client to discover the necessary permissions and AS for accessing a resource, different from the one proposed in <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>: Not specified.<a href="#appendix-A-2.1.1" class="pilcrow">Â¶</a></p>
</li>
        <li class="normal" id="appendix-A-2.2">
          <p id="appendix-A-2.2.1">Optionally, specify new grant types: Not specified.<a href="#appendix-A-2.2.1" class="pilcrow">Â¶</a></p>
</li>
        <li class="normal" id="appendix-A-2.3">
          <p id="appendix-A-2.3.1">Optionally, define the use of client certificates as client credential type: Not specified.<a href="#appendix-A-2.3.1" class="pilcrow">Â¶</a></p>
</li>
        <li class="normal" id="appendix-A-2.4">
          <p id="appendix-A-2.4.1">Specify the communication protocol the client and RS must use: CoAP.<a href="#appendix-A-2.4.1" class="pilcrow">Â¶</a></p>
</li>
        <li class="normal" id="appendix-A-2.5">
          <p id="appendix-A-2.5.1">Specify the security protocol the client and RS must use to protect their communication: Group OSCORE, by using a pre-established Group OSCORE Security Context.<a href="#appendix-A-2.5.1" class="pilcrow">Â¶</a></p>
</li>
        <li class="normal" id="appendix-A-2.6">
          <p id="appendix-A-2.6.1">Specify how the client and the RS mutually authenticate: Explicitly, by possession of a common Group OSCORE Security Context, and by either: usage of digital signatures embedded in messages, if protected with the group mode of Group OSCORE; or protection of messages with the pairwise mode of Group OSCORE, by using pairwise symmetric keys derived from the asymmetric keys of the two peers exchanging the message. Note that mutual authentication is not completed before the client has verified a Group OSCORE response using the corresponding Group OSCORE Security Context.<a href="#appendix-A-2.6.1" class="pilcrow">Â¶</a></p>
</li>
        <li class="normal" id="appendix-A-2.7">
          <p id="appendix-A-2.7.1">Specify the proof-of-possession protocol(s) and how to select one, if several are available. Also specify which key types (e.g., symmetric/asymmetric) are supported by a specific proof-of- possession protocol: Group OSCORE algorithms; asymmetric keys verified and distributed by a Group Manager.<a href="#appendix-A-2.7.1" class="pilcrow">Â¶</a></p>
</li>
        <li class="normal" id="appendix-A-2.8">
          <p id="appendix-A-2.8.1">Specify a unique ace_profile identifier: coap_group_oscore.<a href="#appendix-A-2.8.1" class="pilcrow">Â¶</a></p>
</li>
        <li class="normal" id="appendix-A-2.9">
          <p id="appendix-A-2.9.1">If introspection is supported, specify the communication and security protocol for introspection: HTTP/CoAP (+ TLS/DTLS/OSCORE).<a href="#appendix-A-2.9.1" class="pilcrow">Â¶</a></p>
</li>
        <li class="normal" id="appendix-A-2.10">
          <p id="appendix-A-2.10.1">Specify the communication and security protocol for interactions between the client and AS: HTTP/CoAP (+ TLS/DTLS/OSCORE).<a href="#appendix-A-2.10.1" class="pilcrow">Â¶</a></p>
</li>
        <li class="normal" id="appendix-A-2.11">
          <p id="appendix-A-2.11.1">Specify if/how the /authz-info endpoint is protected, including how error responses are protected: Not protected.<a href="#appendix-A-2.11.1" class="pilcrow">Â¶</a></p>
</li>
        <li class="normal" id="appendix-A-2.12">
          <p id="appendix-A-2.12.1">Optionally, define other methods of token transport than the /authz-info endpoint: Not defined.<a href="#appendix-A-2.12.1" class="pilcrow">Â¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="sec-cddl-model">
<section id="appendix-B">
      <h2 id="name-cddl-model">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-cddl-model" class="section-name selfRef">CDDL Model</a>
      </h2>
<p id="appendix-B-1">This section is to be removed before publishing as an RFC.<a href="#appendix-B-1" class="pilcrow">Â¶</a></p>
<span id="name-cddl-model-2"></span><div id="fig-cddl-model">
<figure id="figure-7">
        <div class="alignLeft art-CDDL art-text artwork" id="appendix-B-2.1">
<pre>
; ACE Profiles
coap_group_oscore = 5

; OAuth Parameters CBOR Mappings
context_id_param = 71
salt_input_param = 72
client_cred_verify = 73
client_cred_verify_mac = 74

; CBOR Web Token (CWT) Claims
context_id_claim = 51
salt_input_claim = 52

; CWT Confirmation Methods
kccs = 14
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-cddl-model-2" class="selfRef">CDDL model</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="sec-document-updates">
<section id="appendix-C">
      <h2 id="name-document-updates">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-document-updates" class="section-name selfRef">Document Updates</a>
      </h2>
<p id="appendix-C-1">This section is to be removed before publishing as an RFC.<a href="#appendix-C-1" class="pilcrow">Â¶</a></p>
<div id="sec-02-03">
<section id="appendix-C.1">
        <h3 id="name-version-02-to-03">
<a href="#appendix-C.1" class="section-number selfRef">C.1. </a><a href="#name-version-02-to-03" class="section-name selfRef">Version -02 to -03</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.1-1.1">
            <p id="appendix-C.1-1.1.1">Lowercase "client", "resource server", "authorization server", and "access token".<a href="#appendix-C.1-1.1.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.1-1.2">
            <p id="appendix-C.1-1.2.1">Consistent update of section numbers for external references.<a href="#appendix-C.1-1.2.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.1-1.3">
            <p id="appendix-C.1-1.3.1">Mentioned that this profile can also use the ACE alternative workflow.<a href="#appendix-C.1-1.3.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.1-1.4">
            <p id="appendix-C.1-1.4.1">Clarified that the client may ask for a new access token after the old one becomes invalid.<a href="#appendix-C.1-1.4.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.1-1.5">
            <p id="appendix-C.1-1.5.1">Added fine-grained recommendations on storing multiple access tokens bound to the same PoP key.<a href="#appendix-C.1-1.5.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.1-1.6">
            <p id="appendix-C.1-1.6.1">Fixes in the IANA considerations.<a href="#appendix-C.1-1.6.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.1-1.7">
            <p id="appendix-C.1-1.7.1">Editorial fixes and improvements.<a href="#appendix-C.1-1.7.1" class="pilcrow">Â¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-01-02">
<section id="appendix-C.2">
        <h3 id="name-version-01-to-02">
<a href="#appendix-C.2" class="section-number selfRef">C.2. </a><a href="#name-version-01-to-02" class="section-name selfRef">Version -01 to -02</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.2-1.1">
            <p id="appendix-C.2-1.1.1">CBOR diagnostic notation uses placeholders from a CDDL model.<a href="#appendix-C.2-1.1.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.2-1.2">
            <p id="appendix-C.2-1.2.1">Renamed the claim 'contextId_input' to 'context_id'.<a href="#appendix-C.2-1.2.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.2-1.3">
            <p id="appendix-C.2-1.3.1">Revised examples.<a href="#appendix-C.2-1.3.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.2-1.4">
            <p id="appendix-C.2-1.4.1">Placeholders and early direction for dynamic update of access rights.<a href="#appendix-C.2-1.4.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.2-1.5">
            <p id="appendix-C.2-1.5.1">Added text on storing multiple access tokens per PoP key on the RS.<a href="#appendix-C.2-1.5.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.2-1.6">
            <p id="appendix-C.2-1.6.1">Fixes in the IANA considerations.<a href="#appendix-C.2-1.6.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.2-1.7">
            <p id="appendix-C.2-1.7.1">Editorial fixes and improvements.<a href="#appendix-C.2-1.7.1" class="pilcrow">Â¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-00-01">
<section id="appendix-C.3">
        <h3 id="name-version-00-to-01">
<a href="#appendix-C.3" class="section-number selfRef">C.3. </a><a href="#name-version-00-to-01" class="section-name selfRef">Version -00 to -01</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.3-1.1">
            <p id="appendix-C.3-1.1.1">Deleting an access token does not delete the Group OSCORE Security Context.<a href="#appendix-C.3-1.1.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.3-1.2">
            <p id="appendix-C.3-1.2.1">Distinct computation of the PoP input when C and the AS use (D)TLS 1.2 or 1.3.<a href="#appendix-C.3-1.2.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.3-1.3">
            <p id="appendix-C.3-1.3.1">Revised computation of the PoP input when C and the AS use OSCORE.<a href="#appendix-C.3-1.3.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.3-1.4">
            <p id="appendix-C.3-1.4.1">Revised computation of the PoP evidence when the OSCORE group is a pairwise-only group.<a href="#appendix-C.3-1.4.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.3-1.5">
            <p id="appendix-C.3-1.5.1">Clarified requirements on the AS for verifying the PoP evidence.<a href="#appendix-C.3-1.5.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.3-1.6">
            <p id="appendix-C.3-1.6.1">Renamed the TLS Exporter Label for computing the PoP input.<a href="#appendix-C.3-1.6.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.3-1.7">
            <p id="appendix-C.3-1.7.1">Editorial fixes and improvements.<a href="#appendix-C.3-1.7.1" class="pilcrow">Â¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="acknowldegment">
<section id="appendix-D">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-D-1"><span class="contact-name">Ludwig Seitz</span> contributed as a co-author of initial versions of this document.<a href="#appendix-D-1" class="pilcrow">Â¶</a></p>
<p id="appendix-D-2">The authors sincerely thank <span class="contact-name">Christian AmsÃ¼ss</span>, <span class="contact-name">Tim Hollebeek</span>, <span class="contact-name">Benjamin Kaduk</span>, <span class="contact-name">John PreuÃ Mattsson</span>, <span class="contact-name">Dave Robin</span>, <span class="contact-name">Jim Schaad</span>, and <span class="contact-name">GÃ¶ran Selander</span> for their comments and feedback.<a href="#appendix-D-2" class="pilcrow">Â¶</a></p>
<p id="appendix-D-3">The work on this document has been partly supported by the Sweden's Innovation Agency VINNOVA and the Celtic-Next projects CRITISEC and CYPRESS; and by the H2020 project SIFIS-Home (Grant agreement 952652).<a href="#appendix-D-3" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-E">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Marco Tiloca</span></div>
<div dir="auto" class="left"><span class="org">RISE AB</span></div>
<div dir="auto" class="left"><span class="street-address">Isafjordsgatan 22</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">16440 Stockholm</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:marco.tiloca@ri.se" class="email">marco.tiloca@ri.se</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Rikard HÃ¶glund</span></div>
<div dir="auto" class="left"><span class="org">RISE AB</span></div>
<div dir="auto" class="left"><span class="street-address">Isafjordsgatan 22</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">16440 Stockholm</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:rikard.hoglund@ri.se" class="email">rikard.hoglund@ri.se</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Francesca Palombini</span></div>
<div dir="auto" class="left"><span class="org">Ericsson AB</span></div>
<div dir="auto" class="left"><span class="street-address">Torshamnsgatan 23</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">16440 Stockholm</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:francesca.palombini@ericsson.com" class="email">francesca.palombini@ericsson.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
